# Spatial {#sec-reg-spatial .unnumbered}

## Misc {#sec-reg-spatial-misc .unnumbered}

-   Packages
    -   [CARBayesST](https://cran.r-project.org/web/packages/CARBayesST/index.html){style="color: #990000"}[}]{style="color: #990000"} ([Vignette](https://www.jstatsoft.org/article/view/v084i09)) - Spatio-Temporal **Generalised Linear Mixed Models** for Areal Unit Data
        -   Binomial, Gaussian, or Poisson available
    -   [{]{style="color: #990000"}[spatialreg](https://r-spatial.github.io/spatialreg/){style="color: #990000"}[}]{style="color: #990000"} - **OG**; Various methods of spatial **regression**, Bivand's package
        -   Spatial Autoregressive Combined (SAC) models combine both a Spatial Autoregression (SAR) model and a Spatial Error (SEM) model
    -   [{]{style="color: #990000"}[spatemR](https://cran.r-project.org/web/packages/spatemR/index.html){style="color: #990000"}[}]{style="color: #990000"} - **Generalized Spatial Autoregressive** Models for Mean and Variance
        -   Extends classical methods like **logistic** Spatial Autoregresive Models (SAR), **probit** Spatial Autoregresive Models (SAR), and **Poisson** Spatial Autoregresive Models (SAR),
        -   Built on top of [{gamlss}]{style="color: #990000"} so splines can be included.
    -   [{]{style="color: #990000"}[spldv](https://cran.r-project.org/web/packages/spldv/index.html){style="color: #990000"}[}]{style="color: #990000"} - Estimates spatial autoregressive models for **binary dependent variables** using GMM estimators
        -   Computes average marginal effects for probit and logit models
-   Papers
    -   [A Review of Software for Spatial Econometrics in R](https://www.mdpi.com/2227-7390/9/11/1276) (2021)
-   Notes from
    -   Bivand's slides and source code, [Categorical independent variables and spatial regression: interpretation and reporting](https://rsbivand.github.io/eqc25_talk/)
    -   Spatial Data Science, [Ch.16](https://r-spatial.org/book/16-SpatialRegression.html), [Ch.17](https://r-spatial.org/book/17-Econometrics.html)

## Econometric {#sec-reg-spatial-econ .unnumbered}

![[source](https://mstdn.social/@geocaruso/114315287372162927)](_resources/Regression-Spatial.resources/econometric-venn-1.png){.lightbox width="532"}

-   [Misc]{.underline}

    -   The spatial lag is usually taken as the mean of the values of the variable at neighbouring observations for row-standardised spatial weights, or the sum for binary spatial weights.
    -   Relatively dense spatial weights matrices may down-weight model estimates, suggesting that sparser weights are preferable
    -   The presence of residual spatial autocorrelation need not bias the estimates of variance of regression coefficients, provided that the covariates themselves do not exhibit spatial autocorrelation
        -   if covariates and the residual are autocorrelated, it is likely that the estimates of variance of regression coefficients will be biased downwards if attempts are not made to model the spatial processes.
    -   Recommended to start from the General Nested Model (GNM) and eliminate unneeded terms
    -   A unit change in a covariate will only impact the response as the value of the regression coefficient if the spatial coefficient of the lagged response is zero.
    -   Where it is non-zero, global spillovers, impacts, come into play, and these impacts should be reported rather than the regression coefficients
    -   Local impacts may be reported for SDEM and SLX models, using a linear combination to calculate standard errors for the total impacts of each covariate (sums of coefficients on the covariates and their spatial lags)
    -   Common use of pre-test strategies for model selection probably ought to be replaced by the estimation of the most general model appropriate for the relationships being modelled.
    -   All covariates should NOT be added in spatially lagged form
    -   If the processes in the covariates and the response match, we should find little difference between the coefficients of a least squares and a SEM, but very often they diverge, suggesting that a Hausman test for this condition should be employed.

-   [[{spatialreg}]{.underline}]{style="color: #990000"} [Model Functions]{.underline}\

    | model | model name | maximum likelihood estimation function |
    |----|----|----|
    | SEM | spatial error | `errorsarlm(..., Durbin=FALSE)` |
    | SEM | spatial error | `spautolm(..., family="SAR")` |
    | SDEM | spatial Durbin error | `errorsarlm(..., Durbin=TRUE)` |
    | SLM | spatial lag | `lagsarlm(..., Durbin=FALSE)` |
    | SDM | spatial Durbin | `lagsarlm(..., Durbin=TRUE)` |
    | SAC | spatial autoregressive combined | `sacsarlm(..., Durbin=FALSE)` |
    | GNM | general nested | `sacsarlm(..., Durbin=TRUE)` |

-   **Spatial Lag Model (SLM)** or **Spatial Autoregressive (SAR)**\
    $$
    y = \rho_{\text{lag}}Wy + X\beta + \epsilon
    $$

    -   Includes a spatial process for the response
    -   $y$ : A $n\times 1$ vector of observations on a response variable taken at each of $n$ locations
    -   $\rho_{\text{lag}}$ : Scalar spatial parameter
    -   $W$ : A $n\times n$ spatial weights matrix
    -   $X$ : A $n\times k$ matrix of covariates usually including the intercept
    -   $\beta$ : A $k\times 1$ vector of parameters
    -   $\epsilon$ : A $n\times 1$ vector of iid *disturbances*

-   **Spatial Error Model (SEM)**\
    $$
    \begin{align}
    &y = X\beta + u \\
    &\text{where} \;\; u = \rho_{\text{err}} Wu + \epsilon
    \end{align}
    $$

    -   Includes a spatial process for the residuals
    -   $u$ : A $n\;\times\;1$ spatially autocorrelated disturbance vector
    -   $\rho_{\text{err}}$ : A scalar spatial parameter.

-   **Spatial Durbin Model (SDM)**\
    $$
    y = \rho_{\text{lag}}Wy + X\beta + WX\gamma + \epsilon
    $$

    -   Includes spatial processes for the response and covariates
    -   $WX$ : Is the spatially weighted, lagged covariates term
    -   $\gamma$ : A $k\;' \times 1$ vector of parameters where often $k' = k - 1$ when using row-standardized spatial weights and ommitting the spatially lagged intercept.
    -   The indirect spillover eﬀect produced by the SDM model is both local and global with no prior restrictions on the magnitudes of these eﬀects
    -   The exogenous regressor of one location casts an eﬀect on the dependent variable of the neighboring locations through *feedback loops*.
        -   The feedback loops are a result of the Durbin term due to which a location, say $i$ aﬀects aneighboring location, say $j$, which eventually has a consequence on $i, j = 1,2, \ldots , n$
    -   An advantage of the spatial Durbin model is that it produces correct standard errors or t−values of the coeﬃcient estimates also if the true data generating process is a spatial error model
    -   The SDM model reduces to SEM under a non-linear common factor restriction. Thus, theoretically speaking, the choice between SDM and SEM can be settled by performing astatistical test for the common factor restriction.
    -   Rao’s score test principle which is asymptotically equivalent to the Likelihood Ratio Test (LRT) but computationally much simpler
        -   Use of the likelihood ratio test (LRT) is not attractive for testing a non-linear hypothesis, since LRT requires maximum likelihood estimation both under the null and the alternative hypotheses.

-   **General Nested Model (GNM)** or **General Nested Spatial Model (GNS)**

    $$
    \begin{align}
    &y = \rho_{\text{lag}}Wy + X\beta + WX\gamma + u \\
    &\text{where} \;\; u = \rho_{\text{err}} Wu + \epsilon
    \end{align}
    $$

    -   Includes a spatial process to the response, covariates, and residuals (kitchen sink model)

-   **Combined Spatial Autocorrelation (SAC)**

    $$
    \begin{align}
    &y = \rho_{\text{lag}}Wy + X\beta + u \\
    &\text{where} \;\; u = \rho_{\text{err}} Wu + \epsilon
    \end{align}
    $$

    -   No spatial process for covariates
    -   AKA **Spatial AutoRegressive-AutoRegressive (SARAR)**

-   **Spatially Lagged X Model (SLX)**

    $$
    y = X\beta + WX\gamma + \epsilon
    $$

    -   Only has a spatial process for the covariates

-   **Error Durbin model (SDEM)**

    $$
    \begin{align}
    &y = X\beta + WX\gamma + u \\
    &\text{where} \;\; u = \rho_{\text{err}} Wu + \epsilon
    \end{align}
    $$

    -   No spatial process for the response
