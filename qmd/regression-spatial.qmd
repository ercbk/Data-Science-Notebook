# Spatial {#sec-reg-spatial .unnumbered}

-   Packages
    -   [{]{style="color: #990000"}[spatialreg](https://r-spatial.github.io/spatialreg/){style="color: #990000"}[}]{style="color: #990000"} - **OG**; Various methods of spatial **regression**, Bivand's package
        -   Spatial Autoregressive Combined (SAC) models combine both a Spatial Autoregression (SAR) model and a Spatial Error (SEM) model
    -   [{]{style="color: #990000"}[spatemR](https://cran.r-project.org/web/packages/spatemR/index.html){style="color: #990000"}[}]{style="color: #990000"} - **Generalized Spatial Autoregressive** Models for Mean and Variance
        -   Extends classical methods like **logistic** Spatial Autoregresive Models (SAR), **probit** Spatial Autoregresive Models (SAR), and **Poisson** Spatial Autoregresive Models (SAR),
        -   Built on top of [{gamlss}]{style="color: #990000"} so splines can be included.
-   Notes from Bivand's slides, [Categorical independent variables and spatial regression: interpretation and reporting](https://rsbivand.github.io/eqc25_talk/bivand_eqc25_pres.pdf)
-   The spatial lag is usually taken as the mean of the values of the variable at neighbouring observations for row-standardised spatial weights, or the sum for binary spatial weights.
-   **Spatial Lag Model (SLM)** or **Spatial Autoregressive (SAR)** has spatially lagged values of the response variable\
    $$
    y = \rho_{\text{lag}}Wy + X\beta + \epsilon
    $$
    -   $y$ : A $n\times 1$ vector of observations on a response variable taken at each of $n$ locations
    -   $\rho_{\text{lag}}$ : Scalar spatial parameter
    -   $W$ : A $n\times n$ spatial weights matrix
    -   $X$ : A $n\times k$ matrix of covariates usually including the intercept
    -   $\beta$ : A $k\times 1$ vector of parameters
    -   $\epsilon$ : A $n\times 1$ vector of iid *disturbances*
-   **Spatial Durbin Model (SDM)** adds spatially lagged covariates to the SLM model\
    $$
    y = \rho_{\text{lag}}Wy + X\beta + WX\gamma + \epsilon
    $$
    -   $\gamma$ : A $k' \times 1$ vector of parameters where often $k' = k - 1$ when using row-standardized spatial weights and ommitting the spatially lagged intercept.
-   Others
    -   **Spatially Lagged X Model (SLX)** omits the $\rho_{\text{lag}}Wy$ term (from the SDM model?)
    -   **General Nested Model (GNM)** or **General Nested Spatial Model (GNS)** adds (to the SDM model?) an additional spatial process in the residuals
        -   Start from the General Nested Model (GNM) and eliminate unneeded terms
-   Venn Diagram of Econometric Spatial Models ([source](https://mstdn.social/@geocaruso/114315287372162927))\
    ![](_resources/Regression-Spatial.resources/econometric-venn-1.png){.lightbox width="532"}
