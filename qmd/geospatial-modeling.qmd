# Modeling {#sec-geo-mod .unnumbered}

## Misc {#sec-geo-mod-misc .unnumbered}

-   Packages
    -   [{]{style="color: #990000"}[spatialsample](https://spatialsample.tidymodels.org/){style="color: #990000"}[}]{style="color: #990000"} - [{tidymodels}]{style="color: #990000"} cross-validation
    -   [{]{style="color: #990000"}[spatialreg](https://r-spatial.github.io/spatialreg/){style="color: #990000"}[}]{style="color: #990000"} - Various methods of spatial regression, Bivand's package
        -   Spatial Autoregressive Combined (SAC) models combine both a Spatial Autoregression (SAR) model and a Spatial Error (SEM) model
    -   [{]{style="color: #990000"}[RandomForestsGLS](https://cran.r-project.org/web/packages/RandomForestsGLS/index.html){style="color: #990000"}[}]{style="color: #990000"} - Generalizaed Least Squares RF
        -   Takes into account the correlation structure of the data. Has functions for spatial RFs and time series RFs
-   Notes from
    -   [Random forests with spatial proxies for environmental modelling: opportunities and pitfalls](https://gmd.copernicus.org/articles/17/6007/2024/)
-   CV
    -   Standard CV methods are known to offer good accuracy estimates for spatial interpolation with regular and random samples, but they generally lead to overoptimistic estimates for spatial-model transfer and interpolation with clustered samples.
    -   Spatial CV Types: Spatial Blocking, Clustering, Sampling-Intensity-Weighted CV, Model-based Geostatistical Approaches, k-fold nearest neighbour distance matching (kNNDM) CV
-   Ways to Account for Spatial Autocorrelation
    -   Add spatial proxies as predictors
        -   Spatial proxies are a set of spatially indexed variables with long or infinite autocorrelation ranges that are not causally related to the response.
        -   They are “proxy” since these predictors act as surrogates for unobserved factors that can cause residual autocorrelation, such as missing predictors or an autocorrelated error term.
        -   Types
            -   Geographical or Projected Coordinates
            -   Euclidean Distance Fields (EDFs)(i.e. distance-to variables?)
                -   Adding distance fields for each of the sampling locations (distance from one location to the other?), i.e. the number of added predictors equals the sample size.
    -   Models
        -   Generalized-Least-Squares-style Random Gorest (RF–GLS) - Relaxes the independence assumption of the RF model by accounting for spatial dependencies in several ways:
            -   Using a global dependency-adjusted split criterion and node representatives instead of the classification and regression tree (CART) criterion used in standard RF models
            -   Employing contrast resampling rather than the bootstrap method used in a standard RF model
            -   Applying residual kriging with covariance modeled using a Gaussian process framework
-   Factors that could affect the effectiveness of spatial proxies
    -   Model Objectives
        -   Interpolation - There is a geographical overlap between the sampling and prediction areas
            -   The addition of spatial proxies to tree models such as RFs may be beneficial in terms of enhancing predictive accuracy, and they might outperform geostatistical or hybrid methods
        -   Prediction (aka Extrapolation, Spatial-Model Transferability) - The model is applied to a new disjoint area
            -   The use of spatial proxies for extrapolation remains unexplored but appears to be problematic: since spatial representation is introduced via predictors and the prediction area is, by definition, different from the sampling area, feature extrapolation will occur when spatial proxies are used, which is problematic for models with poor extrapolation ability, such as RFs
        -   Inference (aka Predictive Inference) - Knowledge discovery is the main focus
            -   Inclusion of spatial proxies has been discouraged
            -   Proxies typically rank highly in variable-importance statistics
            -   High-ranking proxies could hinder the correct interpretation of importance statistics for the rest of predictors, undermining the possibility of deriving hypotheses from the model and hampering residual analysis
    -   Large Residual Autocorrelation
        -   Better performance of models with spatial proxies is expected when residual dependencies are strong.
    -   Spatial Distribution
        -   Clustered samples frequently shown as potentially problematic for models with proxy predictors
        -   Including highly autocorrelated variables, such as coordinates with clustered samples, can result in spatial overfitting 
