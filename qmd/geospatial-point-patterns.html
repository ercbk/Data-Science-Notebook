<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Point Patterns – Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../qmd/geospatial-processing.html" rel="next">
<link href="../qmd/geospatial-modeling.html" rel="prev">
<link href="../images/ds-favicon-32.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-b43b305e8f7f3ad7975af6396d71de14.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-2c59ee7c2d9e3851a6559dec0df522a3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5J13QCM7YC"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5J13QCM7YC', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../qmd/geospatial-analysis.html">Geospatial</a></li><li class="breadcrumb-item"><a href="../qmd/geospatial-point-patterns.html">Point Patterns</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Data Science</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://ericbook.netlify.app/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-house"></i></a>
    <a href="https://ercbk.github.io/Domain-Knowledge-Notebook/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-lightbulb"></i></a>
    <a href="https://ercbk.github.io/Statistical-Rethinking-Notebook/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-book"></i></a>
    <a href="https://github.com/ercbk/Data-Science-Notebook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Algorithms</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/algorithms-learn-to-rank.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learn-to-Rank</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/algorithms-marketing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Marketing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/algorithms-ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">ML</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/algorithms-product.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Product</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/algorithms-recommendation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Recommendation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/anomaly-detection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anomaly Detection</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Apache</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/apache-arrow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Arrow</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/apache-spark.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spark</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/apis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">APIs</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Association</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/association-copulas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Copulas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/association-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/association-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time Series</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/aws.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AWS</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Bayes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/bayes-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/bayes-priors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Priors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/bayes-troubleshooting-hmc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Troubleshooting HMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/bayes-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workflow</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/big-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Big Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/business-plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Business Plots</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/causal-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Causal Inference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Classification</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">CLI</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/cli-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/cli-linux.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linux</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/cli-windows.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Windows</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/cloud-services.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cloud Services</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Clustering</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/clustering-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time Series</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/clustering-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Code</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/code-debug.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Debugging</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/code-optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/code-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Review</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/code-style-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Style Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/code-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testing</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/confidence-and-prediction-intervals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Confidence &amp; Prediction Intervals</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/cross-validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cross-Validation</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">CSS</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/css-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/css-recipes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Recipes</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Databases</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/db-bigquery.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BigQuery</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/db-dbt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">dbt</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/db-duckdb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DuckDB</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/db-engineering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Engineering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/db-feature-stores.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Feature Stores</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/db-lakes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lakes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/db-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/db-normalization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Normalization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/db-nosql.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NoSQL</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/db-other.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Other</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/db-postgres.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Postgres</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/db-relational.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Relational</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/db-vector.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vector Databases</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/db-warehouses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Warehouses</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/decision-intelligence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Decision Intelligence</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Diagnostics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/diagnostics-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/diagnostics-classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Classification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/diagnostics-clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/diagnostics-cv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CV</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/diagnostics-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DL</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/diagnostics-forecasting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Forecasting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/diagnostics-geospatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Geospatial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/diagnostics-glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GLM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/diagnostics-mixed-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed Effects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/diagnostics-model-agnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Agnostic</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/diagnostics-nlp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NLP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/diagnostics-probabilistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/diagnostics-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Distributions</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Deep Learning</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/dl-audio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Audio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/dl-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/dl-graph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Graph</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/dl-image.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Image</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/dl-tabular.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tabular</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/dl-training.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Training</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">Docker</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/docker-aws.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AWS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/docker-fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fundamentals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/docker-misc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Misc</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">Econometrics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/econometrics-discrete-choice-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discrete Choice Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/econometrics-fixed-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fixed Effects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/econometrics-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/econometrics-psa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Propensity Score Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false">
 <span class="menu-text">EDA</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/eda-geospatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Geospatial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/eda-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/eda-multilevel-longitudinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multilevel, Longitudinal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/eda-text.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Text</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/eda-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time Series</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false">
 <span class="menu-text">Experiments</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/experiments-a_b-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A/B Testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/experiments-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/experiments-designs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Designs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/experiments-planning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Planning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/experiments-rct.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RCT</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/experiments-stepped-wedge-cluster-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stepped Wedge Cluster Design</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/extreme-value-theory-(evt).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Extreme Value Theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false">
 <span class="menu-text">Feature Engineering</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/feature-engineering-embeddings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Embeddings</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/feature-engineering-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/feature-engineering-geospatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Geospatial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/feature-engineering-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time Series</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/feature-engineering-splines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Splines</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/feature-engineering-tokenization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tokenization</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false">
 <span class="menu-text">Feature Reduction</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/feature-reduction-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/feature-reduction-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time Series</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/feature-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Feature Selection</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false">
 <span class="menu-text">Forecasting</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/forecasting-decomposition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Decomposition</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/forecasting-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deep Learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/forecasting-ensembling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ensembling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/forecasting-hierarchical_grouped.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hierarchical/Grouped</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/forecasting-ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ML</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/forecasting-multivariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multivariate</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/forecasting-nonlinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nonlinear</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/forecasting-statistical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/generalized-additive-models-(gam).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalized Additive Models</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="true">
 <span class="menu-text">Geospatial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-19" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/geospatial-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/geospatial-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/geospatial-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/geospatial-point-patterns.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Point Patterns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/geospatial-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preprocessing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/geospatial-remote-sensing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Remote Sensing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/geospatial-spatial-weights.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial Weights</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false">
 <span class="menu-text">Git</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-20" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/git-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/git-github-actions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Github Actions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/glossary-ds-terms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Glossary: DS terms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/gnu-make.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GNU Make</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-21" role="navigation" aria-expanded="false">
 <span class="menu-text">Google Analytics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-21" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-21" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/google-analytics-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/google-analytics-reports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reports</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/html.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTML</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-22" role="navigation" aria-expanded="false">
 <span class="menu-text">IDEs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-22" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-22" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/ide-jupyter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Jupyter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/ide-rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/ide-vscode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">VS Code</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/information-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Information Theory</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/inkscape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inkscape</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-23" role="navigation" aria-expanded="false">
 <span class="menu-text">Job</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-23" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-23" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/job-management-leadership.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Management / Leadership</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/job-on-the-job.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">On the job</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/job-organizational-and-team-development.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Organizational and Team Development</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/job-reports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reports</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/job-search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Search</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-24" role="navigation" aria-expanded="false">
 <span class="menu-text">Javascript</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-24" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-24" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/js-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/js-observable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Observable</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/json.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">JSON</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/kubernetes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kubernetes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LaTeX</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-25" role="navigation" aria-expanded="false">
 <span class="menu-text">LLMs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-25" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-25" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/llms-agent-chains.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Agent Chains</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/llms-apps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Apps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/llms-context-engineering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Context Engineering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/llms-fine-tuning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fine Tuning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/llms-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/llms-mcp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Context Protocol (MCP)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/llms-rag.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RAG</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/loss-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loss Functions</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-26" role="navigation" aria-expanded="false">
 <span class="menu-text">Mathematics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-26" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-26" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/mathematics-linear-algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Algebra</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/mathematics-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Glossary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/mathematics-notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/mathematics-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/mathematics-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/misc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Misc</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/missingness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Missingness</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-27" role="navigation" aria-expanded="false">
 <span class="menu-text">Mixed Effects</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-27" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-27" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/mixed-effects-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/mixed-effects-bmlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BMLR</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/mixed-effects-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/mixed-effects-glmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GLMM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/mixed-effects-residual-covar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Residual Covariance Structures</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/mlops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MLOps</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-28" role="navigation" aria-expanded="false">
 <span class="menu-text">Model Building</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-28" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-28" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/model-building-brms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">brms</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/model-building-concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Concepts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/model-building-ensembling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ensembling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/model-building-h2o-automl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">H2O</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/model-building-modeltime.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">modeltime</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/model-building-rstanarm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">rstanarm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/model-building-sklearn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">sklearn</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/model-building-tidymodels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tidymodels</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-29" role="navigation" aria-expanded="false">
 <span class="menu-text">Networks</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-29" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-29" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/networks-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/networks-knowledge-graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Knowledge Graphs</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-30" role="navigation" aria-expanded="false">
 <span class="menu-text">NLP</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-30" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-30" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/nlp-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/nlp-sentiment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sentiment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/nlp-summarization-extraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summarization and Extraction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/nlp-topic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Topic</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/nlp-transformers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transformers</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/optimization-equation-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/outliers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Outliers</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/package-development.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Package Development</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-31" role="navigation" aria-expanded="false">
 <span class="menu-text">Post-Hoc Analysis</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-31" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-31" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/post-hoc-analysis-ab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A/B</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/post-hoc-analysis-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/post-hoc-analysis-emmeans.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">emmeans</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/post-hoc-analysis-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/post-hoc-analysis-multilevel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multilevel</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/privacy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Privacy/Security</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-32" role="navigation" aria-expanded="false">
 <span class="menu-text">Production</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-32" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-32" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/production-data-validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Validation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/production-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deployment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/production-development.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Development</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/production-ml-monitoring.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">ML Monitoring</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/production-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/production-tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tools</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-33" role="navigation" aria-expanded="false">
 <span class="menu-text">Projects</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-33" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-33" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/project-analyses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analyses</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/project-development.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Development</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/project-management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Management</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/project-planning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Planning</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-34" role="navigation" aria-expanded="false">
 <span class="menu-text">Python</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-34" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-34" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/python-classes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Classes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/python-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/python-misc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Misc</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/python-numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numpy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/python-pandas-recipes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pandas, Recipes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/python-pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pandas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/python-polars.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Polars</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/python-reticulate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">reticulate</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/python-snippets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Snippets</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/quarto-rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-35" role="navigation" aria-expanded="false">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-35" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-35" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/r-base-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/r-data-table.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">data.table</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/r-polars.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Polars</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/r-snippets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Snippets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/r-tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tidyverse</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/regex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regex</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-36" role="navigation" aria-expanded="false">
 <span class="menu-text">Regression</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-36" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-36" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/regression-discrete.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discrete</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/regression-interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/regression-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/regression-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/regression-multinomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/regression-multivariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multivariate</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/regression-ordinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ordinal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/regression-other.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Other</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/regression-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantile</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/regression-regularized.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regularized</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/regression-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Survival</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/renv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Renv</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/scraping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scraping</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-37" role="navigation" aria-expanded="false">
 <span class="menu-text">Shiny</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-37" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-37" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/shiny-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/shiny-hosting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hosting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/shiny-mobile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mobile</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/shiny-modules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modules</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/shiny-production.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Production</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/shiny-python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/shiny-ui.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">UI</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/shiny-ui-examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">UI Examples</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/simulation-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulation, Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/spreadsheets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spreadsheets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/sql.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SQL</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/stochastic-processes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stochastic Processes</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-38" role="navigation" aria-expanded="false">
 <span class="menu-text">Surveys</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-38" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-38" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/surveys-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/surveys-census-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Census Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/surveys-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/surveys-sampling-methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampling Methods</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/teaching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Teaching</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/tidyeval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tidyeval</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/tuning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tuning</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-39" role="navigation" aria-expanded="false">
 <span class="menu-text">Visualization</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-39" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-39" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/visualization-general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/visualization-ggplot2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ggplot2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/visualization-gtable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">gtable</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/visualization-diagrams.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diagrams</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/visualization-mixed-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed Effects</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-40" role="navigation" aria-expanded="false">
 <span class="menu-text">Web</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-40" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-40" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/web-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Web Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/web-servers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Server</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-geo-ptpat-misc" id="toc-sec-geo-ptpat-misc" class="nav-link active" data-scroll-target="#sec-geo-ptpat-misc">Misc</a></li>
  <li><a href="#sec-geo-ptpat-terms" id="toc-sec-geo-ptpat-terms" class="nav-link" data-scroll-target="#sec-geo-ptpat-terms">Terms</a></li>
  <li><a href="#sec-geo-ptpat-bas" id="toc-sec-geo-ptpat-bas" class="nav-link" data-scroll-target="#sec-geo-ptpat-bas">Basics</a></li>
  <li><a href="#sec-geo-ptpat-kdens" id="toc-sec-geo-ptpat-kdens" class="nav-link" data-scroll-target="#sec-geo-ptpat-kdens">Kernel Density</a></li>
  <li><a href="#sec-geo-ptpat-csrt" id="toc-sec-geo-ptpat-csrt" class="nav-link" data-scroll-target="#sec-geo-ptpat-csrt">CSR Tests</a></li>
  <li><a href="#sec-geo-ptpat-spdep" id="toc-sec-geo-ptpat-spdep" class="nav-link" data-scroll-target="#sec-geo-ptpat-spdep">Spatial Dependence</a>
  <ul>
  <li><a href="#sec-geo-ptpat-depfun-misc" id="toc-sec-geo-ptpat-depfun-misc" class="nav-link" data-scroll-target="#sec-geo-ptpat-depfun-misc">Misc</a></li>
  <li><a href="#sec-geo-ptpat-depfun-spfun" id="toc-sec-geo-ptpat-depfun-spfun" class="nav-link" data-scroll-target="#sec-geo-ptpat-depfun-spfun">Spacing Functions</a></li>
  <li><a href="#sec-geo-ptpat-depfun-spcor" id="toc-sec-geo-ptpat-depfun-spcor" class="nav-link" data-scroll-target="#sec-geo-ptpat-depfun-spcor">Spatial Correlation</a></li>
  <li><a href="#sec-geo-ptpat-depfun-uncert" id="toc-sec-geo-ptpat-depfun-uncert" class="nav-link" data-scroll-target="#sec-geo-ptpat-depfun-uncert">Uncertainty</a></li>
  </ul></li>
  <li><a href="#sec-geo-ptpat-int" id="toc-sec-geo-ptpat-int" class="nav-link" data-scroll-target="#sec-geo-ptpat-int">Intensity</a>
  <ul>
  <li><a href="#sec-geo-ptpat-int-typ" id="toc-sec-geo-ptpat-int-typ" class="nav-link" data-scroll-target="#sec-geo-ptpat-int-typ">Types</a></li>
  <li><a href="#sec-geo-ptpat-int-covdep" id="toc-sec-geo-ptpat-int-covdep" class="nav-link" data-scroll-target="#sec-geo-ptpat-int-covdep">Covariate Dependence</a></li>
  </ul></li>
  <li><a href="#sec-geo-ptpat-ostuff" id="toc-sec-geo-ptpat-ostuff" class="nav-link" data-scroll-target="#sec-geo-ptpat-ostuff">Other Stuff</a>
  <ul>
  <li><a href="#marked-point-patterns" id="toc-marked-point-patterns" class="nav-link" data-scroll-target="#marked-point-patterns">Marked Point Patterns</a></li>
  <li><a href="#inhomogeneity" id="toc-inhomogeneity" class="nav-link" data-scroll-target="#inhomogeneity">Inhomogeneity</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../qmd/geospatial-analysis.html">Geospatial</a></li><li class="breadcrumb-item"><a href="../qmd/geospatial-point-patterns.html">Point Patterns</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-geo-ptpat" class="quarto-section-identifier">Point Patterns</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-geo-ptpat-misc" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sec-geo-ptpat-misc">Misc</h2>
<ul>
<li>Notes from
<ul>
<li><a href="https://paezha.github.io/spatial-analysis-r/point-pattern-analysis-i.html">Ch.9 - Ch.18</a>, An Introduction to Spatial Data Analysis and Statistics: A Course in R</li>
<li><a href="https://r-spatial.org/book/11-PointPattern.html">Ch.11</a>, Spatial Data Science With Applications in R</li>
<li><span style="color: #990000">{spatstat}</span> book</li>
</ul></li>
<li>Packages
<ul>
<li><span style="color: #990000">{</span><a href="https://cran.r-project.org/web/packages/spatstat/index.html" style="color: #990000">spatstat</a><span style="color: #990000">}</span> - Spatial Point Pattern Analysis, Model-Fitting, Simulation, Tests
<ul>
<li>CRAN page has some vignettes, but the manual is a kind of cheatsheet that lists names of functions that perform certain spatial operations</li>
<li>Loading <span style="color: #990000">{spatstat}</span> loads Spatstat-verse:
<ul>
<li><span style="color: #990000">{</span><a href="https://cran.r-project.org/web/packages/spatstat.data/index.html" style="color: #990000">spatstat.data</a><span style="color: #990000">}</span> - Datasets</li>
<li><span style="color: #990000">{</span><a href="https://cran.r-project.org/web//packages//spatstat.univar/index.html" style="color: #990000">spatstat.univar</a><span style="color: #990000">}</span> - Estimation of one-dimensional probability distributions including kernel density estimation, weighted empirical cumulative distribution functions, Kaplan-Meier and reduced-sample estimators for right-censored data, heat kernels, kernel properties, quantiles and integration.</li>
<li><span style="color: #990000">{</span><a href="https://cran.r-project.org/web/packages/spatstat.geom/index.html" style="color: #990000">spatstat.geom</a><span style="color: #990000">}</span> - Defines spatial data types and supports geometrical operations on them. Data types include point patterns, windows (domains), pixel images, line segment patterns, tessellations and hyperframes</li>
<li><span style="color: #990000">{</span><a href="https://cran.r-project.org/web/packages/spatstat.random/index.html" style="color: #990000">spatstat.random</a><span style="color: #990000">}</span> - Generates random spatial patterns of points</li>
<li><span style="color: #990000">{</span><a href="https://cran.r-project.org/web/packages/spatstat.explore/index.html" style="color: #990000">spatstat.explore</a><span style="color: #990000">}</span> - Exploratory data analysis and nonparametric analysis of spatial data, mainly spatial point patterns</li>
<li><span style="color: #990000">{</span><a href="https://cran.r-project.org/web/packages/spatstat.model/index.html" style="color: #990000">spatstat.model</a><span style="color: #990000">}</span> - Parametric statistical modelling and inference for spatial data, mainly spatial point patterns</li>
<li><span style="color: #990000">{</span><a href="https://cran.r-project.org/web/packages/spatstat.linnet/index.html" style="color: #990000">spatstat.linnet</a><span style="color: #990000">}</span> - Defines types of spatial data on a linear network and provides functionality for geometrical operations, data analysis and modelling of data on a linear network</li>
</ul></li>
</ul></li>
<li><span style="color: #990000">{</span><a href="https://cran.r-project.org/web/packages/stpp/index.html" style="color: #990000">stpp</a><span style="color: #990000">}</span> - Space-Time Point Pattern Simulation, Visualisation and Analysis
<ul>
<li>Many of the models encountered in applications of point process methods to the study of spatio-temporal phenomena are covered</li>
</ul></li>
<li><span style="color: #990000">{</span><a href="https://cran.r-project.org/web/packages/splancs/index.html" style="color: #990000">splancs</a><span style="color: #990000">}</span> - Spatial and Space-Time Point Pattern Analysis</li>
<li><span style="color: #990000">{</span><a href="https://cran.r-project.org/web/packages/kanova/index.html" style="color: #990000">kanova</a><span style="color: #990000">}</span> - One-way and two-way analysis of variance for replicated point patterns, grouped by one or two classification factors, on the basis of the corresponding K-functions.</li>
<li><span style="color: #990000">{</span><a href="https://cran.r-project.org/web/packages/groupedHyperframe/index.html" style="color: #990000">groupedHyperframe</a><span style="color: #990000">}</span> - Grouped Hyper Data Frame: An Extension of Hyper Data Frame Object
<ul>
<li>Aggregation of function-value-table hyper column(s) and numeric hyper column(s) over a nested grouping structure</li>
<li><span style="color: #990000">{</span><a href="https://cran.r-project.org/web/packages/groupedHyperframe.random/index.html" style="color: #990000">groupedHyperframe.random</a><span style="color: #990000">}</span> - Simulated Grouped Hyper Data Frame</li>
<li><span style="color: #990000">{</span><a href="https://cran.r-project.org/web/packages/hyper.gam/index.html" style="color: #990000">hyper.gam</a><span style="color: #990000">}</span> - Generalized Additive Models with Hyper Column</li>
</ul></li>
</ul></li>
<li>Resources
<ul>
<li><span style="color: #990000">{spatstat}</span> book: Spatial Point Patterns: Methodology and Applications with R (R &gt;&gt; Documents &gt;&gt; Geospatial)</li>
<li><a href="https://paezha.github.io/spatial-analysis-r/">An Introduction to Spatial Data Analysis and Statistics: A Course in R</a></li>
<li><a href="https://jakubnowosad.com/posts/2024-10-13-spatcomp-bp1/">Inventory of methods for comparing spatial patterns in raster data</a>
<ul>
<li>Teaches you how to analyze how the physical arrangement of observations in one raster differs from the physical arrangement of observations in another raster.</li>
<li>Nowosad series of posts for continuous and categorical raster data in overlapping and arbitrary areas</li>
<li>Reasons
<ul>
<li>Study of change (i.e., how the spatial pattern of a landscape has changed over time)</li>
<li>Study of similarity (i.e., how similar the spatial pattern of two landscapes is)</li>
<li>Study of association (i.e., how the spatial pattern of one theme is associated with the spatial pattern of another theme)</li>
<li>Spatial model assessment (i.e., how well a model output matches the spatial pattern of the reference data)</li>
</ul></li>
</ul></li>
</ul></li>
<li>Examples of Point Processes (Papers covering this topics listed in <span style="color: #990000">{spatstat}</span> book, p.&nbsp;142)
<ul>
<li>A silicon wafer is inspected for defects in the crystal surface, and the locations of all defects are recorded
<ul>
<li>Questions for study would include frequency of defects, spatial trends in intensity, and spacing between defects</li>
</ul></li>
<li>Earthquake aftershocks in Japan are detected and the epicentre latitude and longitude and the time of occurrence are recorded.
<ul>
<li>These data could be analysed as a spatio-temporal point process, or as a marked point process in two-dimensional space.</li>
<li>If the occurrence times are ignored, it may be analysed as a spatial point process.</li>
</ul></li>
<li>The locations of petty crimes that occurred in the past week are plotted on a street map of Chicago.
<ul>
<li>Questions for study include the frequency of crimes, spatial variation in intensity, and evidence for clusters of crimes</li>
</ul></li>
<li><em>A tiger shark is captured, tagged with a satellite transmitter, and released. Over the next month its location is reported daily. These points are plotted on a map.</em>
<ul>
<li>Not a point process, since the events recorded serially (i.e.&nbsp;in sequence)</li>
</ul></li>
<li><em>A herd of deer is photographed from the air at noon each day for 10 days. Each photograph is processed to produce a point pattern of individual deer locations on a map.</em>
<ul>
<li>Each day produces a point pattern that could be analysed as a realisation of a point process. However, the observations on successive days are dependent (e.g., having constant herd size and systematic foraging behaviour).</li>
<li>A pragmatic alternative may be to treat the data as a spatio-temporal point process.</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="sec-geo-ptpat-terms" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sec-geo-ptpat-terms">Terms</h2>
<ul>
<li><p><span style="color: #009499"><strong>Correlation-Stationary</strong></span> - The pair correlation between points u and v depends only on their relative position. (<span style="color: #990000">{spatstat}</span> book, p.&nbsp;243)</p>
<ul>
<li>This would be true if the process is stationary, but is also true for an inhomogeneous Poisson process and for many other processes.</li>
</ul></li>
<li><p><span style="color: #009499"><strong>Covariates</strong></span> - Any data treated as explanatory, rather than as part of the ‘response’</p>
<ul>
<li>In contrast to <strong>marks</strong>, covariates seem to be spatial information about the location and not information about the thing at the location .</li>
<li>e.g.&nbsp;the altitude, slope of terrain, hydrology (depth to water table, annual recharge flow), soil (soil type, acidity), understorey vegetation at tree locations</li>
<li>Can also be other point patterns, e.g.&nbsp;fault lines near metal deposits or a potential cancer causing substance or thing near cancer cases.</li>
</ul></li>
<li><p><span style="color: #009499"><strong>Independence</strong></span> - Information about the outcome in one region of space has no influence on the outcome in other regions. (<span style="color: #990000">{spatstat}</span> book, pp.&nbsp;131-133)</p>
<ul>
<li>The number of points in quadrat A does not influence how many points are in quadrat B no matter the size of the quadrats.</li>
</ul></li>
<li><p><span style="color: #009499"><strong>Intensity</strong></span> - The <em>expected</em> number of events per unit area — conventionally denoted by <span class="math inline">\(\lambda\)</span>. In most cases the process is not know, so its intensity cannot be directly measured. (<span style="color: #990000">{spatstat}</span> book, Ch.6 p.&nbsp;157)</p></li>
<li><p><span style="color: #009499"><strong>Isotropic</strong></span> - Same as <strong>Stationarity</strong> but instead of talking about a shifting window, statistical properties are unaffected by rotations, i.e.&nbsp;orientation.</p></li>
<li><p><span style="color: #009499"><strong>Density</strong></span> - Empirical estimate of <strong>Intensity</strong> — <span class="math inline">\(\hat \lambda = n / a\)</span> , where <span class="math inline">\(a\)</span> is the area of the region</p></li>
<li><p><span style="color: #009499"><strong>Homogeneity</strong></span> - In a general sense, this means the points have no preference for any spatial location (e.g.&nbsp;constant intensity for all windows, quadrats, etc.)</p></li>
<li><p><span style="color: #009499"><strong>Inhomogeneous</strong></span> - The average density of points is spatially varying (i.e.&nbsp;density is a function of location) (<span style="color: #990000">{spatstat}</span> book, pp.&nbsp;137-138)</p>
<ul>
<li>For an inhomogeneous Poisson process, independence still holds.</li>
</ul></li>
<li><p><span style="color: #009499"><strong>Interaction</strong></span> - Stochastic dependence between points (e.g.&nbsp;positive and negative correlation, clustering, inhibition or repelling)</p></li>
<li><p><span style="color: #009499"><strong>Marks</strong></span> - Auxiliary information attached to each point in the point pattern</p>
<ul>
<li>In contrast to <strong>covariates</strong>, marks seem to be information about the thing at the location and not spatial information about the location.</li>
<li>e.g.&nbsp;a tree’s species, and diameter</li>
<li>e.g.&nbsp;a catalogue of star locations may give their sky masses, magnitudes, shapes, and colors</li>
<li>e.g.&nbsp;disease case locations may be linked to detailed clinical records</li>
</ul></li>
<li><p><span style="color: #009499"><strong>Point Process</strong></span> - Assumes that the point pattern is random (in the general sense, i.e.&nbsp;the locations and number of points are not fixed) and that the point pattern is the response or observation of interest.</p></li>
<li><p><span style="color: #009499"><strong>Quadrats</strong></span> - Cells of a gridded area representing subregions. Useful for analyzing how density varies across a region</p>
<ul>
<li>Rules of Thumb for choosing the number of quadrats
<ul>
<li>Each quadrat should have a minimum of two events</li>
<li>Formula based on the area (A) and number of events (N)<br>
<span class="math display">\[
Q = \frac{2A}{N}
\]</span></li>
</ul></li>
</ul></li>
<li><p><span style="color: #009499"><strong>Regularity</strong></span> (or <span style="color: #009499"><strong>Dispersion</strong></span>) - The state at which points tend to be located at similar distances from each other.</p></li>
<li><p><span style="color: #009499"><strong>Stationary</strong></span> - The size and coordinates of the window doesn’t affect the point process’ statistical properties. This implies that ntensity is constant (homogeneous).</p></li>
<li><p><span style="color: #009499"><strong>Tesselation</strong></span> - A division of space into non-overlapping regions. These regions are called ‘tiles’ and their shapes are arbitrary. Often used to represent administrative or political divisions, such as the subdivision of a country into states or provinces. (<span style="color: #990000">{spatstat}</span> book p.120)</p>
<ul>
<li><p>Also see</p>
<ul>
<li><a href="../qmd/geospatial-point-patterns.html#sec-geo-ptpat-terms" style="color: green">Terms</a> &gt;&gt; Intensity &gt;&gt; Example 2</li>
<li>Other Stuff &gt;&gt; Inhomogeneous &gt;&gt; EDA &gt;&gt; Example</li>
<li>p. 689 in the <span style="color: #990000">{spatstat}</span> book, a permutation test procedure</li>
</ul></li>
<li><p>Types</p>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/term-tess-type-1.png" class="lightbox" data-gallery="tess-type-1" title="retangular"><img src="_resources/Geospatial-Point-Patterns.resources/term-tess-type-1.png" class="img-fluid figure-img" width="232" alt="retangular"></a></p>
<figcaption>retangular</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/term-tess-type-2.png" class="lightbox" data-gallery="tess-type-1" title="tile list"><img src="_resources/Geospatial-Point-Patterns.resources/term-tess-type-2.png" class="img-fluid figure-img" width="232" alt="tile list"></a></p>
<figcaption>tile list</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/term-tess-type-3.png" class="lightbox" data-gallery="tess-type-1" title="pixellated"><img src="_resources/Geospatial-Point-Patterns.resources/term-tess-type-3.png" class="img-fluid figure-img" width="232" alt="pixellated"></a></p>
<figcaption>pixellated</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rectangular</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quadrats</span>(W, nx, ny) <span class="co"># nx and ny are number of vert and horiz quadrats</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tess</span>(<span class="at">xgrid =</span> xg, <span class="at">ygrid =</span> yg) <span class="co"># xg, yg are vecs of vert and horiz grid lines </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># tile list</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tess</span>(<span class="at">tiles =</span> z) <span class="co"># z is list of windows (class "owin")</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># pixellated</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tess</span>(<span class="at">image=</span>Z) <span class="co"># e Z is a pixel image with factor values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><code>as.tess</code> can also be used to convert other types of data to a tessellation</li>
</ul></li>
<li><p>Algorithms</p>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/term-tess-algo-1.png" class="lightbox" data-gallery="tess-algo-1" title="Dirichlet"><img src="_resources/Geospatial-Point-Patterns.resources/term-tess-algo-1.png" class="img-fluid figure-img" width="232" alt="Dirichlet"></a></p>
<figcaption>Dirichlet</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/term-tess-algo-2.png" class="lightbox" data-gallery="tess-algo-1" title="Delaunay"><img src="_resources/Geospatial-Point-Patterns.resources/term-tess-algo-2.png" class="img-fluid figure-img" width="232" alt="Delaunay"></a></p>
<figcaption>Delaunay</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dirichlet</span>(ppp_obj)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">delaunay</span>(ppp_obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><em>Dirichlet</em>: The tile associated with a given point of the pattern is the region of space which is closer to that point than to any other point of the pattern.</li>
<li><em>Delaunay</em>: A network of straight lines connecting the points. Two points of the pattern are joined if their Dirichlet tiles share a common edge. The resulting network defines a set of non-overlapping triangles, which cover the convex hull of the point pattern rather than the entire window containing the point pattern.</li>
</ul></li>
<li><p>Operations</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tess_obj) <span class="co"># plot.tess</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> A[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)] <span class="co"># subset tiles where A is a tesselation</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>A_w <span class="ot">&lt;-</span> A[W] <span class="co"># by window</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>ls_A <span class="ot">&lt;-</span> <span class="fu">tiles</span>(A) <span class="co"># list of tiles</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tile.areas</span>(A) <span class="co"># areas</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(ls_A, diameter) <span class="co"># diameters</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">split</span>(ppp_obj, A) <span class="co"># list of tiles with points</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul></li>
</ul>
</section>
<section id="sec-geo-ptpat-bas" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sec-geo-ptpat-bas">Basics</h2>
<ul>
<li><p><span class="ribbon-highlight">Example 1</span>: Quadrats<br>
<a href="_resources/Geospatial-Point-Patterns.resources/basics-geom-bin2d-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="_resources/Geospatial-Point-Patterns.resources/basics-geom-bin2d-1.png" class="img-fluid" width="382"></a></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  dplyr,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  ggplot2,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  spatstat</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"PointPatterns"</span>, <span class="at">package =</span> <span class="st">"isdas"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(PointPatterns)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="do">##        x                y                 Pattern  </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  Min.   :0.0169   Min.   :0.005306   Pattern 1:60  </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  1st Qu.:0.2731   1st Qu.:0.289020   Pattern 2:60  </span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  Median :0.4854   Median :0.550000   Pattern 3:60  </span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mean   :0.5074   Mean   :0.538733   Pattern 4:60  </span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  3rd Qu.:0.7616   3rd Qu.:0.797850                 </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  Max.   :0.9990   Max.   :0.999808</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bin2d</span>(<span class="at">data =</span> <span class="fu">filter</span>(PointPatterns, </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                           Pattern <span class="sc">==</span> <span class="st">"Pattern 1"</span>),</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> y),</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">binwidth =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>                          <span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">filter</span>(PointPatterns, </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>                           Pattern <span class="sc">==</span> <span class="st">"Pattern 1"</span>), </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"RdBu"</span>) <span class="sc">+</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><code>geom_bin2d</code> is called to plot a map of counts of events in the space defined by the bins.</li>
<li><span class="var-text">PointPatterns</span> contains <span class="var-text">x</span>, <span class="var-text">y</span> coordinates that range from 0 to 1 and a categorical variable Pattern indicating each of the four difffernt density patterns</li>
</ul></li>
<li><p><span class="ribbon-highlight">Example 2</span>: Create a ppp object</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a window</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>wnd <span class="ot">&lt;-</span> <span class="fu">owin</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>ppp1 <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(PointPatterns, wnd)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ppp1)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Marked planar point pattern:  240 points</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Average intensity 240 points per square unit</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Coordinates are given to 16 decimal places</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Multitype:</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="do">##           frequency proportion intensity</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Pattern 1        60       0.25        60</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Pattern 2        60       0.25        60</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Pattern 3        60       0.25        60</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Pattern 4        60       0.25        60</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Window: rectangle = [0, 1] x [0, 1] units</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Window area = 1 square unit</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># plot a specific category of point</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">split.ppp</span>(ppp1)<span class="sc">$</span><span class="st">`</span><span class="at">Pattern 3</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The window defined in <code>owin</code> should define a region for analysis that is consistent with the pattern of interest</li>
<li><code>ppp</code> (plannar point pattern) is the fundamental spatstat object</li>
<li><span class="arg-text">frequency</span> is the number of points in that region (e.g.&nbsp;<span class="var-text">Pattern</span>)</li>
<li><span class="arg-text">proportion</span> is the proportion of points in that region to the overall dataset</li>
<li><span class="arg-text">intensity</span> it the number of points divided by the area (1 x 1 = 1)</li>
</ul></li>
<li><p><span class="ribbon-highlight">Example 3</span>: Get point counts for each quadrat by region/subregion</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quadratcount</span>(<span class="fu">split</span>(ppp1),</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">nx =</span> <span class="dv">4</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">ny =</span> <span class="dv">4</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="do">## List of spatial objects</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Pattern 1:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="do">##             x</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="do">## y            [0,0.25) [0.25,0.5) [0.5,0.75) [0.75,1]</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0.75,1]          3          5          1        6</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0.5,0.75)        2          3          4        6</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0.25,0.5)        5          4          2        3</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0,0.25)          2          4          4        6</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Pattern 2:</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="do">##             x</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="do">## y            [0,0.25) [0.25,0.5) [0.5,0.75) [0.75,1]</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0.75,1]         14          2          2        6</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0.5,0.75)        0          0          4        6</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0.25,0.5)        6          3          1        2</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0,0.25)          4          6          2        2</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Pattern 3:</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="do">##             x</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="do">## y            [0,0.25) [0.25,0.5) [0.5,0.75) [0.75,1]</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0.75,1]          2         11          5        7</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0.5,0.75)        1          1          6        4</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0.25,0.5)        1         10          3        2</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0,0.25)          2          1          2        2</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Pattern 4:</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="do">##             x</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="do">## y            [0,0.25) [0.25,0.5) [0.5,0.75) [0.75,1]</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0.75,1]          4          5          6        3</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0.5,0.75)        3          3          4        2</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0.25,0.5)        3          3          4        2</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="do">##   [0,0.25)          5          4          6        3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><span class="arg-text">nx</span> and <span class="arg-text">ny</span> specify how many quadrats (i.e.&nbsp;cells) you want per row and per column respectively</li>
<li><code>split</code> divides the dataset by the region variable or event type</li>
</ul></li>
<li><p><span class="ribbon-highlight">Example 4</span>: Quadrat Count for Toronto Fast Food<br>
<a href="_resources/Geospatial-Point-Patterns.resources/ff-qct-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="_resources/Geospatial-Point-Patterns.resources/ff-qct-1.png" class="img-fluid" width="332"></a></p>
<div class="sourceCode" id="annotated-cell-7"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-7-1"><a href="#annotated-cell-7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="annotated-cell-7-2"><a href="#annotated-cell-7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="annotated-cell-7-3"><a href="#annotated-cell-7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-7-4"><a href="#annotated-cell-7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Fast_Food"</span>, <span class="at">package =</span> <span class="st">"isdas"</span>)</span>
<span id="annotated-cell-7-5"><a href="#annotated-cell-7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Toronto"</span>, <span class="at">package =</span> <span class="st">"isdas"</span>)</span>
<span id="annotated-cell-7-6"><a href="#annotated-cell-7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-7-7"><a href="#annotated-cell-7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Fast_Food)</span>
<span id="annotated-cell-7-8"><a href="#annotated-cell-7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 6 features and 1 field</span></span>
<span id="annotated-cell-7-9"><a href="#annotated-cell-7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geometry type: POINT</span></span>
<span id="annotated-cell-7-10"><a href="#annotated-cell-7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="annotated-cell-7-11"><a href="#annotated-cell-7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: 620173 ymin: 4840698 xmax: 638544.7 ymax: 4853394</span></span>
<span id="annotated-cell-7-12"><a href="#annotated-cell-7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Projected CRS: NAD83 / UTM zone 17N</span></span>
<span id="annotated-cell-7-13"><a href="#annotated-cell-7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Class                 geometry</span></span>
<span id="annotated-cell-7-14"><a href="#annotated-cell-7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Chicken POINT (635575.8 4853394)</span></span>
<span id="annotated-cell-7-15"><a href="#annotated-cell-7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Chicken POINT (636724.5 4842644)</span></span>
<span id="annotated-cell-7-16"><a href="#annotated-cell-7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Chicken POINT (622524.7 4840698)</span></span>
<span id="annotated-cell-7-17"><a href="#annotated-cell-7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Chicken POINT (638544.7 4846541)</span></span>
<span id="annotated-cell-7-18"><a href="#annotated-cell-7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Chicken POINT (627850.5 4843178)</span></span>
<span id="annotated-cell-7-19"><a href="#annotated-cell-7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Chicken   POINT (620173 4841782)</span></span>
<span id="annotated-cell-7-20"><a href="#annotated-cell-7-20" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(toronto)</span>
<span id="annotated-cell-7-21"><a href="#annotated-cell-7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 1 feature and 0 fields</span></span>
<span id="annotated-cell-7-22"><a href="#annotated-cell-7-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span id="annotated-cell-7-23"><a href="#annotated-cell-7-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="annotated-cell-7-24"><a href="#annotated-cell-7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: 609550.5 ymin: 4826375 xmax: 651611.8 ymax: 4857439</span></span>
<span id="annotated-cell-7-25"><a href="#annotated-cell-7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Projected CRS: NAD83 / UTM zone 17N</span></span>
<span id="annotated-cell-7-26"><a href="#annotated-cell-7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                         geometry</span></span>
<span id="annotated-cell-7-27"><a href="#annotated-cell-7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 MULTIPOLYGON (((609550.5 48...</span></span>
<span id="annotated-cell-7-28"><a href="#annotated-cell-7-28" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-7-29" class="code-annotation-target"><a href="#annotated-cell-7-29" aria-hidden="true" tabindex="-1"></a>ppp_ff <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(Fast_Food, <span class="fu">as.owin</span>(Toronto))</span>
<span id="annotated-cell-7-30"><a href="#annotated-cell-7-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Marked planar point pattern: 614 points</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-7-31" class="code-annotation-target"><a href="#annotated-cell-7-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multitype, with levels = Chicken, Hamburger, Pizza, Sub</span></span>
<span id="annotated-cell-7-32"><a href="#annotated-cell-7-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; window: polygonal boundary</span></span>
<span id="annotated-cell-7-33"><a href="#annotated-cell-7-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; enclosing rectangle: [609550.5, 651611.8] x [4826375, 4857439] units</span></span>
<span id="annotated-cell-7-34"><a href="#annotated-cell-7-34" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-7-35" class="code-annotation-target"><a href="#annotated-cell-7-35" aria-hidden="true" tabindex="-1"></a>qct_ff <span class="ot">&lt;-</span> <span class="fu">quadratcount</span>(ppp_ff, <span class="at">nx =</span> <span class="dv">3</span>, <span class="at">ny =</span> <span class="dv">3</span>)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-7-36" class="code-annotation-target"><a href="#annotated-cell-7-36" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(qct_ff)</span>
<span id="annotated-cell-7-37"><a href="#annotated-cell-7-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0   6  44  48  60  64  85 144 163 </span></span>
<span id="annotated-cell-7-38"><a href="#annotated-cell-7-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1   1   1   1   1   1   1   1   1 </span></span>
<span id="annotated-cell-7-39"><a href="#annotated-cell-7-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-7-40"><a href="#annotated-cell-7-40" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(qct_ff)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="29" data-code-annotation="1">To automatically create a window object using the boundaries from a sf object, <span style="color: #990000">{sf}</span> needs to be loaded.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="31" data-code-annotation="2">The categories in the <span class="var-text">Class</span> variable are captured as levels</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="35" data-code-annotation="3">3 x 3 seems to be a good starting grid for regions such as a city if your data isn’t too sparse</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="36" data-code-annotation="4">There is 1 quadrat with 0 points. Given that were using a 3 x3 grid, it’s very small and probably located underneath the quadrat with 44 points.</span>
</dd>
</dl></li>
<li><p><span class="ribbon-highlight">Example 5</span>: Approximate a window using coordinates</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(bear_df, <span class="at">package =</span> <span class="st">"isdas"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bear_df)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">##        x                y                  marks    </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Min.   :515743   Min.   :6812138   Day Time  :502  </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  1st Qu.:518994   1st Qu.:6813396   Night Time:498  </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Median :519526   Median :6816724                   </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mean   :519321   Mean   :6816474                   </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  3rd Qu.:519982   3rd Qu.:6818111                   </span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  Max.   :522999   Max.   :6821440</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">owin</span>(<span class="at">xrange =</span> <span class="fu">c</span>(<span class="dv">515000</span>, <span class="dv">523500</span>), </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">yrange =</span> <span class="fu">c</span>(<span class="dv">6812000</span>, <span class="dv">6822000</span>))</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>bear.ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(bear_df, <span class="at">W =</span> W)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bear.ppp)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Marked planar point pattern:  1000 points</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Average intensity 1.176471e-05 points per square unit</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Coordinates are given to 10 decimal places</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Multitype:</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="do">##            frequency proportion    intensity</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Day Time         502      0.502 5.905882e-06</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Night Time       498      0.498 5.858824e-06</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Window: rectangle = [515000, 523500] x [6812000, 6822000] units</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="do">##                     (8500 x 10000 units)</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Window area = 8.5e+07 square units</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Uses the minimum and maximum values of each coordinate</li>
</ul></li>
<li><p>Various Object Manipulations</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># change the window of a ppp obj</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>new_ppp <span class="ot">&lt;-</span> ppp_obj[W] <span class="co"># W is a window object of class "owin"</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># SpatialPoints class</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">as.ppp</span>(sp_pts)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># "SpatialPolygons" class; e.g. US State boundaries</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 1</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">as.owin</span>(sp_poly_obj) <span class="co"># combines all states into one obj i.e. US country map</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 Create a separate window for each state</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>regions <span class="ot">&lt;-</span> <span class="fu">slot</span>(sp_poly_obj, <span class="st">"polygons"</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>regions <span class="ot">&lt;-</span> </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(regions,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>         <span class="cf">function</span>(x) { <span class="fu">SpatialPolygons</span>(<span class="fu">list</span>(sp_poly_obj)) })</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>windows <span class="ot">&lt;-</span> <span class="fu">solapply</span>(regions, as.owin) <span class="co"># list of owin objs</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>te <span class="ot">&lt;-</span> <span class="fu">tess</span>(<span class="at">tiles =</span> windows)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co"># "SpatialPolygonsDataFrame"</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">as</span>(columbus, <span class="st">"SpatialPolygons"</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>cregions <span class="ot">&lt;-</span> <span class="fu">slot</span>(cp, <span class="st">"polygons"</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>cregions <span class="ot">&lt;-</span> <span class="fu">lapply</span>(cregions, <span class="cf">function</span>(x){ <span class="fu">SpatialPolygons</span>(<span class="fu">list</span>(x)) })</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>cwindows <span class="ot">&lt;-</span> <span class="fu">solapply</span>(cregions, as.owin)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>ch <span class="ot">&lt;-</span> <span class="fu">hyperframe</span>(<span class="at">window=</span>cwindows)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>ch <span class="ot">&lt;-</span> <span class="fu">cbind.hyperframe</span>(ch, columbus<span class="sc">@</span>data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>See <span style="color: #990000">{spatstat}</span> book p.&nbsp;76 for other GIS object manipulations</li>
<li><span style="color: #990000">{maptools}</span> is no more and many of it’s functionalities were transferred to <span style="color: #990000">{sf}</span>, so just loading that package makes most of this stuff pretty painless.</li>
<li>For an object of class “SpatialPolygonsDataFrame” (geometry + variables), the result is a hyperframe containing a column of “owin” objects followed by the columns of auxiliary data</li>
</ul></li>
</ul>
</section>
<section id="sec-geo-ptpat-kdens" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sec-geo-ptpat-kdens">Kernel Density</h2>
<ul>
<li><p>Kernel density is a smooth estimate of the underlying intensity of the process, and the degree of smoothing is controlled by the bandwidth</p>
<ul>
<li>A map of the kernel density is better able to capture the variations in density across the region.</li>
</ul></li>
<li><p>Misc</p>
<ul>
<li>The choice of bandwidth involves a tradeoff between bias and variance: as bandwidth increases, typically the bias increases and variance decreases.</li>
<li>Edge effects in uncorrected estimates will show the intensity decreasing at the window boundaries</li>
<li>Densities estimates at each point can be used as weights in a model: <code>density(swp, sigma = 1, at = "points")</code></li>
<li>Standard Errors: <code>dse &lt;- density(swp, 1, se=TRUE)$SE</code>
<ul>
<li>Although the standard error provides an indication of accuracy, and is justified by asymptotic theory, confidence intervals based on the standard error are notoriously unreliable</li>
<li>Should have a <code>plot</code> method</li>
</ul></li>
<li>A fixed smoothing bandwidth (like in <code>density</code>) is unsatisfactory if the true intensity varies <em>greatly</em> across the spatial domain, because it is likely to cause oversmoothing in the high-intensity areas and undersmoothing in the low intensity areas. (e.g.&nbsp;bad for seismology)
<ul>
<li>Solution: <strong>Adaptive Smoothing</strong>
<ul>
<li>Dirichlet-Voronoï estimator (f<span class="arg-text">= 1</span>): <code>adaptive.density(swp, f=1)</code></li>
<li><span style="color: #990000">{</span><a href="https://tilmandavies.github.io/sparr/" style="color: #990000">sparr</a><span style="color: #990000">}</span> - Provides a suite of adaptive kernel spatial smoothing techniques and related tools</li>
</ul></li>
<li>Solution: <strong>Nearest-Neighbor</strong>
<ul>
<li>Example: 10th Nearest Neighbor Estimate: <code>nndensity(swp, k=10)</code></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>Process</p>
<ul>
<li>Each quadrat is treated as independent of the others in the window.</li>
<li>There isn’t a grid of quadrats but in essence, one that slides around the study area.</li>
<li>it gives greater weight to events that are close to the center of the window, and less weight to events that are more distant from the center of the window</li>
<li>The kernel function visits each point on a fine grid and obtains an estimate of the density by summing the weights of all events.</li>
<li>The shape of the Gaussian kernel depends on the standard deviation, which controls how “big” the window is, or alternatively, how quickly the function decays via decreasing weights. We will call the standard deviation the kernel bandwidth of the function.</li>
</ul></li>
<li><p><span style="color: #990000">{spatstat.explore::density.ppp}</span> - Kernel smoothed intensity function from a point pattern</p>
<ul>
<li><span class="arg-text">kernel</span>: “gaussian”,&nbsp;“epanechnikov”,&nbsp;“quartic”&nbsp;or&nbsp;“disc”
<ul>
<li>Default is Gaussian. The only other kernel that I’ve seen mentioned in the book or docs is the Epanechnikov kernel which is used for Pair Correlation (See <a href="../qmd/geospatial-point-patterns.html#sec-geo-ptpat-depfun-spcor" style="color: green">Spatial Dependence &gt;&gt; Spatial Correlation</a> &gt;&gt; Pair Correlation), so I have no idea what the other ones are used for or why.</li>
</ul></li>
<li><span class="arg-text">weights</span>: Optional weights to be attached to the points</li>
<li><span class="arg-text">diggle</span>: Logical. If TRUE, use the Jones-Diggle improved edge correction, which is more accurate but slower to compute than the default correction.</li>
<li><span class="arg-text">sigma</span>: Bandwidth
<ul>
<li><code>bw.ppl</code> assumes an inhomogeneous Poisson process. Uses a likelihood cross-validation method
<ul>
<li>Tends to select more appropriate values than other methods when the pattern consists predominantly of tight clusters</li>
</ul></li>
<li><code>bw.diggle</code> assumes a Cox process, which is more clustered (positively correlated) than a Poisson process. Uses a mean square error cross-validation method
<ul>
<li>Best when trying to detect a single tight cluster in the midst of random noise</li>
</ul></li>
<li><code>bw.frac</code> for a fast bandwidth selection rule based on the window geometry
<ul>
<li>Probably best for larger datasets</li>
</ul></li>
</ul></li>
</ul></li>
<li><p><span class="ribbon-highlight">Example</span>: Fast Food in Toronto<br>
<a href="_resources/Geospatial-Point-Patterns.resources/dens-ff-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="_resources/Geospatial-Point-Patterns.resources/dens-ff-1.png" class="img-fluid" width="632"></a></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sf dfs</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Fast_Food"</span>, <span class="at">package =</span> <span class="st">"isdas"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Toronto"</span>, <span class="at">package =</span> <span class="st">"isdas"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create a ppp obj</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>ppp_ff <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(Fast_Food, <span class="fu">as.owin</span>(Toronto))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate densities for each type of fast food</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>kernel_density <span class="ot">&lt;-</span> <span class="fu">density</span>(<span class="fu">split</span>(ppp_ff), <span class="at">sigma =</span> bw.diggle)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">1.1</span>, <span class="dv">2</span>))</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>purrr<span class="sc">::</span><span class="fu">pwalk</span>(</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    kernel_density,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">split.ppp</span>(ppp_ff), <span class="co"># add pts</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(kernel_density)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  \(x1, x2, x3) {</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(x1, <span class="at">main =</span> x3)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(x2, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><code>bw.diggle</code> calculates the bandwidth using cross-validation. It’s part of one of the group of sub-packages, <span style="color: #990000">{spatstat.explore}</span>, that automatically gets loaded. There do seem to be other options, but I chose this based on the example in the Pebesma-Bivand <a href="https://r-spatial.org/book/11-PointPattern.html">book</a>.</li>
<li>If you just want to plot the densities without the points, it’s <code>plot(kernel_density)</code></li>
<li>See <code>spatstat.geom::plot.im</code> for beaucoup styling options for the density plot. I didn’t add it here, but when there aren’t any other labels, I kind of liked the <span class="arg-text">addcontour = TRUE</span> as an extra density cue especially for the darker colors.</li>
<li>Note that density color scales have different ranges in the legends</li>
</ul></li>
</ul>
</section>
<section id="sec-geo-ptpat-csrt" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sec-geo-ptpat-csrt">CSR Tests</h2>
<ul>
<li><p>Completely Spatially Random (CSR) (<span style="color: #990000">{spatstat}</span> book, pp.&nbsp;135-136)</p>
<ul>
<li>Every point in a quadrat is independent and uniformly distributed</li>
<li>When two CSR patterns are combined their intensities are additive.</li>
</ul></li>
<li><p>These simple numerical indexes of spatial pattern are useful when a large number of different point patterns need to be compared, or to monitor changes in spatial clustering over time. Their main weakness is that they compress all the spatial information into a single number, conflating information from different spatial scales and different spatial locations.</p></li>
<li><p>10 realizations (i.e.&nbsp;potential patterns) of the <em>same</em> random point process<br>
<a href="_resources/Geospatial-Point-Patterns.resources/csr-10-rand-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="_resources/Geospatial-Point-Patterns.resources/csr-10-rand-1.png" class="img-fluid"></a></p></li>
<li><p><u>Quadrat-based Chi-Square Test</u></p>
<ul>
<li><p>A Pearson <span class="math inline">\(\chi^2\)</span> independence test that compares the empirical distribution of events by quadrats to the distribution of events as expected under the hypothesis that the underlying process is random. (i.e.&nbsp;tests homogeneity assuming independence)<br>
<span class="math display">\[
    \begin{align}
    &amp;\chi^2 = \sum_i^Q r_i^2\\
    &amp;\text{where} \;\; r_i = \frac{\text{observed}_i - \text{expected}_i}{\sqrt{\text{expected}_i}}
    \end{align}
    \]</span></p>
<ul>
<li><span class="math inline">\(r_i\)</span> is the Pearson residual and <span class="math inline">\(Q\)</span> is the number of quadrats</li>
</ul></li>
<li><p>If there’s a variable available and there’s reason to believe that it has an influence on intensity, then use the <span class="math inline">\(\chi^2\)</span> + covariate version as it has more power. (See <a href="../qmd/geospatial-point-patterns.html#sec-geo-ptpat-int-covdep" style="color: green">Intensity &gt;&gt; Covariate Dependence</a> &gt;&gt; Tests &gt;&gt; Quadrat-based <span class="math inline">\(\chi^2\)</span> test)</p></li>
<li><p>Hypotheses</p>
<ul>
<li>H<sub>0</sub>: The point process is homogeneous Poisson process</li>
<li>H<sub>a</sub>: It’s not</li>
</ul></li>
<li><p>Reasons for Rejection of the Null</p>
<ul>
<li>Intensity is not homogeneous</li>
<li>Events/points are not independent
<ul>
<li>When there are a lot of events in each quadrat, this reason can be discarded.</li>
<li>See <a href="../qmd/geospatial-point-patterns.html#sec-geo-ptpat-int-covdep" style="color: green">Intensity &gt;&gt; Covariate Dependence</a> &gt;&gt; Tests &gt;&gt; Quadrat-based <span class="math inline">\(\chi^2\)</span> test &gt;&gt; Example</li>
</ul></li>
</ul></li>
<li><p>Issues</p>
<ul>
<li>Test results is affected by the chosen quadrat grid.</li>
<li>Count-based so size of the quadrat matters. With irregular shaped quadrats (e.g.&nbsp;within a city boundary), it might be difficult to create a grid with roughly homogeneous counts.</li>
<li>The test is <em>not</em> sensitive to the relative position of the events within the quadrats. So, there could be extreme clustering happening within the quadrats and the test might not reject the Null.</li>
</ul></li>
<li><p>It’s recommended to compute the variance-to-mean ratio or <span class="math inline">\(\chi^2\)</span> statistic for different sizes of quadrats, and to plot the statistic against quadrat size.</p></li>
<li><p><span style="color: #990000">{spatstat.explore::quadrat.test}</span></p>
<ul>
<li>If <span class="arg-text">lambda</span> is provided then the Null is a Poisson point process with that <span class="math inline">\(\lambda\)</span> (i.e.&nbsp;intensity or probably also Poisson mean)</li>
<li>Multiples from multiple study areas can be pooled: <code>pool(test1, test2, test3)</code></li>
<li>Can also use <code>split.ppp(ppp_ff)</code> and have each point category tested.</li>
<li>This function has methods for point patterns (class “ppp”), split point patterns (class “splitppp”), point process models (class “ppm” or “slrm”`) and quadrat count tables (class “quadratcount”).</li>
<li>Plotting the object will display the quadrats, annotated by their observed and expected counts and the Pearson residuals.</li>
<li>Pearson residuals can be extracted with <code>residuals</code>. They evidently aren’t standardized, but if standardized, they can be treated as z-scores with values &gt; 1.96 indicating which quadrats are causing the rejection of the Null. (See <a href="../qmd/diagnostics-regression.html#sec-diag-reg-res" style="color: green">Regression, Diagnostics &gt;&gt; Residuals</a> &gt;&gt; Standardized Residuals)</li>
</ul></li>
<li><p><span class="ribbon-highlight">Example</span>: <code>quadrat.test</code> using a ppp object<br>
<a href="_resources/Geospatial-Point-Patterns.resources/quadtest-fastfood-ex-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="_resources/Geospatial-Point-Patterns.resources/quadtest-fastfood-ex-1.png" class="img-fluid" width="432"></a></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sf dfs</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Fast_Food"</span>, <span class="at">package =</span> <span class="st">"isdas"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Toronto"</span>, <span class="at">package =</span> <span class="st">"isdas"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create a ppp obj</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>ppp_ff <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(Fast_Food, <span class="fu">as.owin</span>(Toronto))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>q_test <span class="ot">&lt;-</span> </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quadrat.test</span>(ppp_ff, </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">nx =</span> <span class="dv">3</span>, </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">ny =</span> <span class="dv">3</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>q_test</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Some expected counts are small; chi^2 approximation may be inaccurate</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  Chi-squared test of CSR using quadrat counts</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  Fast_Food.ppp</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="do">## X2 = 213.74, df = 8, p-value &lt; 2.2e-16</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="do">## alternative hypothesis: two.sided</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Quadrats: 9 tiles (irregular windows)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>All expected counts (assumes a uniform Poisson point process) should be greater than 5 which is why there’s a warning.
<ul>
<li>The docs of this function sound very much like the stuff in my Discrete Analysis notebook, so see that for further details.</li>
<li>Options seem to be to use <span class="arg-text">method = “MonteCarlo”</span> which relaxes the expected count &gt; 5 condition or using a smaller grid.</li>
</ul></li>
<li>p-value &lt; 0.05 suggests that this is <em>not</em> a CSR (completely spatially random — aka uniform Poisson point process) pattern</li>
</ul></li>
</ul></li>
<li><p><u>Cressie-Read Power Divergence Test</u></p>
<ul>
<li><span class="math inline">\(\chi^2\)</span>-based family of tests</li>
<li>Hypotheses (Same as previous section)
<ul>
<li>H<sub>0</sub>: The point process is homogeneous Poisson process</li>
<li>H<sub>a</sub>: It’s not</li>
</ul></li>
<li>Test Statistic<br>
<span class="math display">\[
2nI = \frac{2}{\text{CR}(\text{CR} + 1)} \sum_i \left[\left(\frac{X_i}{E_i}\right)^{CR}-1\right]
\]</span>
<ul>
<li><span class="math inline">\(X_i\)</span> is the ith observed count</li>
<li><span class="math inline">\(E_i\)</span> is the ith expected count</li>
<li><span class="math inline">\(\text{CR}\)</span> options
<ul>
<li><span class="math inline">\(\text{CR} = -2\)</span> results in the Neyman modified statistc (NM<sup>2</sup>)</li>
<li><span class="math inline">\(\text{CR} = -1\)</span> results in the modified likelihood ratio test statistic (GM<sup>2</sup>)</li>
<li><span class="math inline">\(\text{CR} = -\frac{1}{2}\)</span> results in the Freeman-Tukey statistic (T<sup>2</sup>)
<ul>
<li>More robust to small expected frequencies</li>
</ul></li>
<li><span class="math inline">\(\text{CR} = 0\)</span> results in the likelihood ratio test statistic (G<sup>2</sup>)
<ul>
<li>More sensitive to small observed frequencies</li>
</ul></li>
<li><span class="math inline">\(\text{CR} = \frac{2}{3}\)</span> is the recommnedation by Cressie-Read
<ul>
<li>A compromise between Pearson’s Chi-Square and the Likelihood Ratio</li>
</ul></li>
<li><span class="math inline">\(\text{CR} = 1\)</span> results in the Pearson <span class="math inline">\(\chi^2\)</span> statistic (previous section)
<ul>
<li>Balanced sensitivity to small counts</li>
</ul></li>
</ul></li>
</ul></li>
<li><span style="color: #990000">{spatstat.explore::quadrat.test}</span> has a <span class="arg-text">CR</span> argument</li>
</ul></li>
<li><p><u>Clark-Evans Test</u></p>
<ul>
<li><p>Assumes the distribution of a distance-based index is Normal and applies NHST to the pattern’s estimated index.</p></li>
<li><p>Clark-Evans Index, <span class="math inline">\(R\)</span><br>
<span class="math display">\[
R =\frac{\sqrt{\bar \lambda}}{m} \sum_i^m d_i
\]</span></p>
<ul>
<li><span class="math inline">\(d_i\)</span> is a nearest-neighbor distance for event <span class="math inline">\(i\)</span> out of <span class="math inline">\(m\)</span> events</li>
<li><span class="math inline">\(\bar \lambda = n \;/\; |W|\)</span> is the average intestity for the entire point pattern</li>
</ul></li>
<li><p>Guidelines</p>
<ul>
<li><span class="math inline">\(R \gt 1\)</span> suggests regularity</li>
<li><span class="math inline">\(R =1\)</span> is consistent with a CSR</li>
<li><span class="math inline">\(R \lt 1\)</span> suggests clustering</li>
</ul></li>
<li><p>Assumes point process is stationary (i.e.&nbsp;constant intensity)</p>
<ul>
<li>An inhomogeneous point pattern will typically give R &lt; 1, and can produce spurious significance</li>
</ul></li>
<li><p>Test requires edge effects correction otherwise R will be positively biased</p></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat}</span> book, p.&nbsp;259<br>
<a href="_resources/Geospatial-Point-Patterns.resources/csr-ce-ex1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="_resources/Geospatial-Point-Patterns.resources/csr-ce-ex1-1.png" class="img-fluid" width="332"></a></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"redwood"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(redwood)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(redwood)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Planar point pattern:  62 points</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Average intensity 62 points per square unit</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coordinates are given to 3 decimal places</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; i.e. rounded to the nearest multiple of 0.001 units</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Window: rectangle = [0, 1] x [-1, 0] units</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     (1 x 1 units)</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Window area = 1 square unit</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans.test</span>(redwood, </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction =</span> <span class="st">"donnelly"</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative =</span> <span class="st">"clustered"</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Clark-Evans test</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Donnelly correction</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Z-test</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  redwood</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R = 0.58499, p-value = 1.906e-11</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: clustered (R &lt; 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul></li>
<li><p><u>Hopskell-Skellam Test</u></p>
<ul>
<li><p>Assumes the distribution of a distance-based index is F and applies NHST to the pattern’s estimated index.</p></li>
<li><p>Hopskell-Skellam Index, <span class="math inline">\(A\)</span><br>
<span class="math display">\[
A = \frac{\sum_i^m d_i^2}{\sum_i^m e_i^2}
\]</span></p>
<ul>
<li><span class="math inline">\(d_i\)</span> is the distance the event <span class="math inline">\(i\)</span>’s nearest neighbor from <span class="math inline">\(m\)</span> randomly sampled events</li>
<li><span class="math inline">\(e_i\)</span> is the distance of point <span class="math inline">\(i\)</span>’s (event or empty space) nearest neighbor from <span class="math inline">\(m\)</span> randomly sampled points</li>
</ul></li>
<li><p>Guidelines</p>
<ul>
<li><span class="math inline">\(A \gt 1\)</span> is consistent with regularity</li>
<li><span class="math inline">\(A = 1\)</span> is consistent with CSR</li>
<li><span class="math inline">\(A \lt 1\)</span> is consistent with clustering</li>
</ul></li>
<li><p>The Hopkins-Skellam index is much less sensitive than the Clark-Evans index to problems such as edge effect bias and spatial inhomogeneity</p></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat}</span> book, p.&nbsp;259</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hopskel.test</span>(redwood, <span class="at">alternative=</span><span class="st">"clustered"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Hopkins-Skellam test of CSR</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  using F distribution</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  redwood</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; A = 0.18176, p-value &lt; 2.2e-16</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: clustered (A &lt; 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>See the Clark-Evans Test example for details in the <span class="var-text">redwood</span> dataset (ppp object)</li>
</ul></li>
</ul></li>
<li><p><u>MAD Test</u></p>
<ul>
<li><p>Equivalent to plotting the global envelopes and declaring a statistically significant outcome if the estimated function wanders <em>outside</em> the global envelope anywhere</p>
<ul>
<li>See <a href="../qmd/geospatial-point-patterns.html#sec-geo-ptpat-depfun-uncert" style="color: green">Uncertainty</a> &gt;&gt; Simulation Envelopes</li>
</ul></li>
<li><p>H<sub>0</sub>: CSR</p></li>
<li><p>H<sub>a</sub>: Not CSR</p></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat}</span> book, p.&nbsp;259</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>swp <span class="ot">&lt;-</span> <span class="fu">rescale</span>(swedishpines)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mad.test</span>(<span class="at">X =</span> swp, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">fun =</span> Lest, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">nsim =</span> <span class="dv">99</span>, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">rmax =</span> <span class="dv">2</span>, </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">use.theory =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Maximum absolute deviation test of CSR</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Monte Carlo test based on 99 simulations</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Summary function: L(r)</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Reference function: theoretical</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Alternative: two.sided</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Interval of distance values: [0, 2] metres</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Test statistic: Maximum absolute deviation</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Deviation = observed minus theoretical</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  swp</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mad = 0.29999, rank = 1, p-value = 0.01</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>For details on <span class="var-text">swp</span> (Swedish Pines), see the example in <a href="../qmd/geospatial-point-patterns.html#sec-geo-ptpat-depfun-uncert" style="color: green">Uncertainty</a> &gt;&gt; Simulation Envelopes</li>
<li>The p-value &lt; 0.05, so not CSR</li>
<li><span class="arg-text">fun = Lest</span> says use the L Function (See <a href="../qmd/geospatial-point-patterns.html#sec-geo-ptpat-depfun-spcor" style="color: green">Spatial Correlation</a> &gt;&gt; L-Function)</li>
<li><span class="arg-text">rmax = 2</span> says test the distance range, <span class="math inline">\(0 \le r \le 2 \; \text{meters}\)</span>. Argument from <code>Kest</code> which <code>Lest</code> is a transformation of.
<ul>
<li>This value can be gotten from the output of the <code>envelope</code> function. (See the example in <a href="../qmd/geospatial-point-patterns.html#sec-geo-ptpat-depfun-uncert" style="color: green">Uncertainty</a> &gt;&gt; Simulation Envelopes). In the example, the max range was 2.4 m, but I guess he just rounded down.</li>
</ul></li>
<li><span class="arg-text">use.theory = TRUE</span> says use the theoretical value of the function as the reference value. TRUE is the default if Y is a ppp or ppm object which <span class="var-text">swp</span> is. So this specification was probably unnecessary.</li>
</ul></li>
</ul></li>
<li><p><u>DCLF Test</u></p>
<ul>
<li><p>Based on the MSE between the empirical summary function and the theoretical function over a range of distance values.</p>
<ul>
<li>Similar to the MAD test since it uses simulation via <code>envelope</code> and some sort of spatial dependence function</li>
</ul></li>
<li><p>More powerful than the MAD test provided the maximum distance is chosen carefully; the MAD test is more reliable when little information is available about the range of dependence.</p>
<ul>
<li>Not sure what this means. The envelope function gives you a recommended range for <span class="math inline">\(r\)</span> (see the example in <a href="../qmd/geospatial-point-patterns.html#sec-geo-ptpat-depfun-uncert" style="color: green">Uncertainty</a> &gt;&gt; Simulation Envelopes). Maybe it’s talking about getting the distance from pair correlation, domain knowledge, or a range established by the literature.</li>
</ul></li>
<li><p>H<sub>0</sub>: CSR</p></li>
<li><p>H<sub>a</sub>: Not CSR</p></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat}</span> book, p.&nbsp;259</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>swp <span class="ot">&lt;-</span> <span class="fu">rescale</span>(swedishpines)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dclf.test</span>(<span class="at">X =</span> swp, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">fun =</span> Lest, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">nsim =</span> <span class="dv">99</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">rmax =</span> <span class="dv">2</span>, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">use.theory =</span> <span class="cn">TRUE</span>, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Diggle-Cressie-Loosmore-Ford test of CSR</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Monte Carlo test based on 99 simulations</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Summary function: L(r)</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Reference function: theoretical</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Alternative: two.sided</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Interval of distance values: [0, 2] metres</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Test statistic: Integral of squared absolute deviation</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Deviation = observed minus theoretical</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  swp</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u = 0.046781, rank = 3, p-value = 0.03</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>See MAD test example for details on the ppp object, function arguments, etc.</li>
<li>The p-value &lt; 0.05, so not CSR</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="sec-geo-ptpat-spdep" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sec-geo-ptpat-spdep">Spatial Dependence</h2>
<section id="sec-geo-ptpat-depfun-misc" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="sec-geo-ptpat-depfun-misc">Misc</h3>
<ul>
<li>tl;dr:
<ul>
<li>Run the J Function if you want to analyze the overall pattern of the study area</li>
<li>Run the L Function if you want to analyze patterns at all scales of the study area
<ul>
<li>Think… the point pattern of 1st order neighbors area, the pattern of 1st and 2nd order neighbors area, etc.</li>
<li>Use <span class="arg-text">correction = “best”</span></li>
</ul></li>
<li>You should probably use both J and L as they technically measure different things but the interpretations of the results have similar implications. i.e.&nbsp;come at the analysis from multiple angles</li>
<li>Use a Simulation Envelope and Loh bootstrap or Block Variance method for the functions to include uncertainty in the analysis</li>
</ul></li>
<li>Basic Assumptions
<ul>
<li>An appropriate window selection is used
<ul>
<li>If at all possible, the region should be selected in such a way that it is consistent with the underlying process. This is not always possible, either because the underlying process is not known, or because of limitations in data collection capabilities.</li>
</ul></li>
<li>All events within the window have been identified
<ul>
<li>No solutions were given for <em>sampled</em> events, so the technique is discouraged.</li>
</ul></li>
</ul></li>
<li>From the <span style="color: #990000">{spatstat}</span> book
<ul>
<li>When interpreting the dependence functions: “the careful scientist will not say that this ‘indicates’ clustering, but that it is ‘consistent with’ clustering, or that it indicates ‘positive association’ between points”</li>
<li>“Spatial clustering does not imply that the points are organised into identifiable ‘clusters’; merely that they are closer together than would be expected for a completely random pattern.”</li>
<li>Think he’s saying that “clustering” implies a cause and further investigation is required in order to call a “spatial inhomogeneity” a cluster.</li>
</ul></li>
<li>Edge Effects for Spacing Functions
<ul>
<li>When a window is chosen, if events lie outside the window, this can bias the test results. An event at the edge of window may not be close to another event inside the window but may be close to one just outside the window.</li>
<li><span style="color: green">Example</span>: Analysis of pizza restaurants in Toronto may be limited to the city limits. This does not mean that establishments do not exist beyond those boundaries. When the extent of the process exceeds the window used in the analysis, the point pattern is observed only partially, and it is possible that the omitted information regarding the location of events beyond the boundary may introduce some bias.</li>
<li>A bias correction is recommended (especially for F and G but not for J) by using weighting events via <span class="arg-text">correction</span>
<ul>
<li><span class="arg-text">“rs”</span> (reduced-sample): Restricts the analysis to points or locations that are far enough from the boundary so that the entire region of interest (e.g., a circle of radius r) lies within the study area (Available for G and F)
<ul>
<li>You’re essentially removing data at the edges, so there will be a reduction in power</li>
</ul></li>
<li><span class="arg-text">“km”</span> (Kaplan-Mier): Treats the boundary as a “censoring” mechanism, where distances beyond the boundary are treated as censored observations. (Available for G and F)</li>
<li><span class="arg-text">“Hanisch”</span>: Weights observations based on their proximity to the circle boundary drawn for each value of <span class="math inline">\(r\)</span>. Points near the boundary receive lower weights because their neighborhoods are more likely to be truncated. (Available for G)</li>
<li><span class="arg-text">“cs”</span>(Chiu-Stoyan): Same idea as the Hanisch method but taylored for the F-Function.</li>
<li><span class="arg-text">“best”</span>: Chooses the best option based on the data and window geometry</li>
<li><span class="arg-text">“all”</span> : Performs all the corrections, <code>plot</code> will plot each corrected empirical curve so you see their effects</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="sec-geo-ptpat-depfun-spfun" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="sec-geo-ptpat-depfun-spfun">Spacing Functions</h3>
<ul>
<li><p>Functions that measure the ‘nearest-neighbour’ distance from each data point to the nearest other data point</p></li>
<li><p><u>G-Function</u></p>
<ul>
<li><p>A cumulative distribution function of distances that tells you the proportion of events that have a nearest neighbor at a distance less than some value. (i.e.&nbsp;ecdf)</p>
<ul>
<li>e.g.&nbsp;At a distance of 1.5 km, 32% of events/locations have a nearest neighbor at that distance or less.</li>
</ul></li>
<li><p>Edge correction needs to be applied via <span class="arg-text">correction</span> if being used by itself (i.e.&nbsp;not as part of the J-Function)</p></li>
<li><p>Empirical G-Function<br>
<span class="math display">\[
\hat G(r) = \frac{\mathbb{I}(d_{i} \le r), \forall i}{n}
\]</span></p>
<ul>
<li>Where <span class="math inline">\(d_{i}\)</span> is the distance from event/location, <span class="math inline">\(i\)</span>, to its nearest neighbor and <span class="math inline">\(r\)</span> is a distance value</li>
</ul></li>
<li><p>Theoretical G-Function<br>
<span class="math display">\[
G(r) = 1 - e^{-\lambda \pi r^2}
\]</span></p>
<ul>
<li>Represents the Null point generating process from a Poisson distribution</li>
</ul></li>
<li><p>Guidelines</p>
<ul>
<li><span class="math inline">\(\hat G(r) \gt G(r)\)</span> says events are <em>closer</em> together than expected from a random process, i.e.&nbsp;<em>Clustered</em></li>
<li><span class="math inline">\(\hat G(r) \approx G(r)\)</span> says event/location pattern resembles a <em>random</em> process</li>
<li><span class="math inline">\(\hat G(r) \lt G(r)\)</span> says events are <em>further away</em> from each other than expected from a random process, i.e.&nbsp;<em>Dispersed</em> or <em>Regular</em></li>
</ul></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat.explore::Gest}</span><br>
<a href="_resources/Geospatial-Point-Patterns.resources/tests-gfunc-ex-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="_resources/Geospatial-Point-Patterns.resources/tests-gfunc-ex-1.png" class="img-fluid" width="382"></a></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use split to calculate the G-function only for "Pattern 1"</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>g_pattern1 <span class="ot">&lt;-</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Gest</span>(<span class="fu">split</span>(pp0.ppp)<span class="sc">$</span><span class="st">"Pattern 1"</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">correction =</span> <span class="st">"none"</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g_pattern1)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.04</span>, <span class="fl">0.04</span>), </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.5</span>), </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="st">"dotted"</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.04</span>), </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="st">"dotted"</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.04</span>), </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">0.16</span>, <span class="fl">0.16</span>), </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="st">"dotted"</span>, </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>See <a href="../qmd/geospatial-point-patterns.html#sec-geo-ptpat-bas" style="color: green">Basics</a> &gt;&gt; Example 1 for what <span class="var-text">Pattern 1</span> looks like</li>
<li><span class="math inline">\(\hat G(r) \gt G(r)\)</span> indicates clustering</li>
<li>The line shows about 50% of events have a nearest neighbor at a distance of less than approximately 0.04</li>
<li><span class="arg-text">correction</span>: Optional. The edge correction(s) to be used to estimate <span class="math inline">\(G(r)\)</span>. A vector of character strings selected from <span class="arg-text">“none”</span>, <span class="arg-text">“rs”</span>, <span class="arg-text">“km”</span>, <span class="arg-text">“Hanisch”</span> and <span class="arg-text">“best”</span>. Alternatively <span class="arg-text">correction = “all”</span> selects all options.</li>
</ul></li>
</ul></li>
<li><p><u>F-Function</u></p>
<ul>
<li><p>Same as the G-Functions except the distance isn’t from event-to-event but from point-to-event.</p></li>
<li><p>The point is an arbitrary location on a map and not necessarily a location of an event</p></li>
<li><p>Same empirical and theoretical formulas — again, only the <span class="math inline">\(d_i\)</span> measurement is different.</p></li>
<li><p>Edge correction needs to be applied via <span class="arg-text">correction</span> if being used by itself (i.e.&nbsp;not as part of the J-Function)</p></li>
<li><p>Guidelines (Opposite of <span class="math inline">\(G\)</span>)</p>
<ul>
<li><span class="math inline">\(\hat F(r) \gt F(r)\)</span> says <em>empty spaces are closer to events</em> than expected from a random process, i.e.&nbsp;<em>regular</em> or <em>dispersed</em></li>
<li><span class="math inline">\(\hat F(r) \approx F(r)\)</span> says event/location pattern resembles a <em>random</em> process</li>
<li><span class="math inline">\(\hat F(r) \lt F(r)\)</span> says <em>empty spaces are further from events</em> than expected from a random process, i.e.&nbsp;<em>clustered</em></li>
</ul></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat.explore::Fest}</span></p>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 35.6%;justify-content: center;">
<p><a href="_resources/Geospatial-Point-Patterns.resources/test-ffunc-ex-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="_resources/Geospatial-Point-Patterns.resources/test-ffunc-ex-1.png" class="img-fluid" width="282"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 64.4%;justify-content: center;">
<p><a href="_resources/Geospatial-Point-Patterns.resources/test-ffunc-ex-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="_resources/Geospatial-Point-Patterns.resources/test-ffunc-ex-2.png" class="img-fluid" width="510"></a></p>
</div>
</div>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"pp2_df"</span>, <span class="at">package =</span> <span class="st">"isdas"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">owin</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>pp2.ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(pp2_df, <span class="at">W =</span> W)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pp2.ppp)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>f_pattern2 <span class="ot">&lt;-</span> <span class="fu">Fest</span>(pp2.ppp, <span class="at">correction =</span> <span class="st">"none"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f_pattern2)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.097</span>), </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.4</span>), </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"blue"</span>, </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="st">"dotted"</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.045</span>, <span class="fl">0.045</span>), </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">0.0</span>, <span class="fl">0.4</span>), </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"blue"</span>, </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="st">"dotted"</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.097</span>, <span class="fl">0.097</span>), </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">0.0</span>, <span class="fl">0.4</span>), </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"blue"</span>, </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="st">"dotted"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><span class="math inline">\(\hat F \lt F\)</span> indicates clustering</li>
<li>Under the theoretical function 40% of points have a nearest event that is at a distance of approximately 0.045 or less, under the empirical function, the events are generally more distant from the points</li>
</ul></li>
</ul></li>
<li><p><u>J-Function</u></p>
<ul>
<li><p>A ratio of the G and F functions</p></li>
<li><p>The uncorrected estimate of <span class="math inline">\(J\)</span> is approximately unbiased (if the process is close to Poisson); it is insensitive to edge effects, and should be used when edge effects are severe.</p></li>
<li><p>Formula</p>
<p><span class="math display">\[
J(r) = \frac{1-G(r)}{1-F(r)}
\]</span></p></li>
<li><p><span style="color: #990000">{spatstat.explore::Jest}</span></p>
<ul>
<li>Values for G and F are also returned by the function</li>
</ul></li>
<li><p>Guidelines</p>
<ul>
<li><span class="math inline">\(J(r) \gt 1\)</span> indiates <em>dispersion</em> or <em>regularity</em></li>
<li><span class="math inline">\(J(r) \approx 1\)</span> indicates a random process</li>
<li><span class="math inline">\(J(r) \lt 1\)</span> indicates <em>clustering</em></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="sec-geo-ptpat-depfun-spcor" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="sec-geo-ptpat-depfun-spcor">Spatial Correlation</h3>
<ul>
<li><p><u>K-Function</u></p>
<ul>
<li><p>AKA Ripley’s K-Function</p></li>
<li><p>The K-Function can be a guide on creating a model, but more commonly the K-function is only a rough guide to the required behaviour of the model.</p></li>
<li><p>Assumes homogeneity of intensity</p>
<ul>
<li>If the process is not stationary, deviations between the empirical and theoretical functions are not necessarily evidence of <em>inter-point interaction</em>, since they may also be attributable to <em>variations in intensity</em></li>
</ul></li>
<li><p>Instead of only using distances to first order neighbors, it takes into account multiple orders of neighbors.</p></li>
<li><p>The interaction between to points doesn’t necessarily happen at <span class="math inline">\(r\)</span>. From <span style="color: #990000">{spatstat}</span> book, p.&nbsp;212:</p>
<ul>
<li>“For point processes which have a well-defined scale of interaction, it is not always true that the greatest deviation in the K-function occurs when r is equal to the scale of interaction. The K-function reflects correlation between pairs of points, not direct dependence. Dependence between points at one scale can give rise to correlation between points at another scale.”</li>
<li>“<span class="math inline">\(K(r)\)</span> accumulates contributions from all distances less than or equal to <span class="math inline">\(r\)</span>. If a pattern of emergent seedlings yields <span class="math inline">\(K(r) &gt; \pi r^2\)</span> for the distance <span class="math inline">\(r = 10\)</span> metres, this does not necessarily indicate that seedlings are clustered at distances of 10 metres. A plausible explanation is that seedlings are organised in clusters at a much smaller spatial scale, and the cumulative effect is still evident at 10 metres.”</li>
<li>“The K-function is optimal for detecting interpoint interaction that occurs equally at all distances up to a certain maximum distance <span class="math inline">\(r\)</span>”</li>
</ul></li>
<li><p>Different types of patterns can be present at different scales (<span class="var-text">pp3.ppp</span> plot)<br>
<a href="_resources/Geospatial-Point-Patterns.resources/test-kfunc-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="_resources/Geospatial-Point-Patterns.resources/test-kfunc-1.png" class="img-fluid" width="232"></a></p>
<ul>
<li>Overall there’s clustering but the clusters are regularly spaced.</li>
<li>At the cluster-level, events look to possibly have a random pattern.</li>
<li>F and G will indicate clustering but not recognize the regular spacing of the clusters</li>
</ul></li>
<li><p>Process: At each event, neighbors are counted at some radius, r. Then r is increased and neighbors are counted again. This continues until all events have been counted as a neighbor. (See <a href="../qmd/geospatial-spatial-weights.html#sec-geo-swgt-diag" style="color: green">Geospatial, Spatial Weights &gt;&gt; Diagnostics &gt;&gt; Connectedness</a> for details on higher order neighbors)</p></li>
<li><p>Empirical Formula<br>
<span class="math display">\[
\hat K(r) = \frac{1}{\hat \lambda (n-1)} \sum_i \sum_{j \ne i} \mathbb{I}(d_{ij} \le r)e_{ij}
\]</span></p>
<ul>
<li><span class="math inline">\(\hat \lambda\)</span> is the estimated intensity (i.e.&nbsp;density)</li>
<li>The rest is summing all instances where the distances (<span class="math inline">\(d_{ij}\)</span>) from event, <span class="math inline">\(i\)</span>, to all the other events, <span class="math inline">\(j\)</span> is less than <span class="math inline">\(r\)</span>.</li>
<li><span class="math inline">\(e_{ij}\)</span> is the edge correction method</li>
</ul></li>
<li><p>Theoretical Formula<br>
<span class="math display">\[
K(r) = \pi r^2
\]</span></p></li>
<li><p>Guidelines</p>
<ul>
<li><span class="math inline">\(\hat K(r) \gt K(r)\)</span> says events are <em>closer</em> together than expected from a random process, i.e.&nbsp;<em>Clustered</em></li>
<li><span class="math inline">\(\hat K(r) \approx K(r)\)</span> says event/location pattern resembles a <em>random</em> process
<ul>
<li>Even with this result, it’s possible that the processe is not a Poisson process (so that there is dependence amongst the points) (<span style="color: #990000">{spatstat}</span> book, p.&nbsp;211)</li>
</ul></li>
<li><span class="math inline">\(\hat K(r) \lt K(r)\)</span> says events are <em>further away</em> from each other than expected from a random process, i.e.&nbsp;<em>Inhibition (repulsion)</em></li>
</ul></li>
<li><p>Edge <span class="arg-text">correction</span> methods should be applied</p>
<ul>
<li>Details about these corrections can be found in the <span style="color: #990000">{spatstat}</span> book, pp.&nbsp;212-220</li>
<li><span class="arg-text">“border”</span> (aka “reduced sample” estimator): The least efficient (statistically) and the fastest to compute. It can be computed for a window of arbitrary shape.
<ul>
<li>See Misc &gt;&gt; Edge Effects &gt;&gt; “rs” (reduced-sample)</li>
</ul></li>
<li><span class="arg-text">“border.motif”</span>: A weighted version of the <span class="arg-text">“border”</span> method
<ul>
<li>Similar to Misc &gt;&gt; Edge Effects &gt;&gt; “hanisch”</li>
</ul></li>
<li><span class="arg-text">“isotropic”</span>/<span class="arg-text">“Ripley”</span>: The weight is the circumference of the circle specified by <span class="math inline">\(r\)</span> divided by the circle’s proportion of the whole window (without overlapping the boundary)<br>
<span class="math display">\[
e(u,r) = \frac{2 \pi r}{\text{length}(c(u,r) \cap W)}
\]</span>
<ul>
<li>“The denominator is the length of the overlap between this circle and the window <span class="math inline">\(W\)</span>.”
<ul>
<li><span class="math inline">\(u\)</span> is the point and <span class="math inline">\(c(u,r\)</span>) is the “circle.” It says “length” so maybe it’s the arclength of circle that intersects the boundary.</li>
</ul></li>
<li>Implemented for rectangular and polygonal windows (not for binary masks).</li>
<li>See <span style="color: #990000">{spatstat.explore::edge.Ripley}</span></li>
</ul></li>
<li><span class="arg-text">“translate”</span>/<span class="arg-text">“translation”</span>: Implemented for all window geometries, but slow for complex windows.<br>
<span class="math display">\[
e(u,r) = \frac{\text{area}(W)}{\text{area}(W \cap (W + y - x))}
\]</span>
<ul>
<li><span class="math inline">\(W + y − x\)</span> is the result of shifting the window <span class="math inline">\(W\)</span> by the vector <span class="math inline">\(y − x\)</span>. The denominator is the area of the overlap between this shifted window and the original window.</li>
<li>See <span style="color: #990000">{spatstat.explore::edge.Trans}</span></li>
</ul></li>
<li><span class="arg-text">“rigid”</span>: There’s no documentation for this method that I can find. Looking at the code, it looks similar to <span class="arg-text">“translate”</span> since its seems to have a shifting window feature.
<ul>
<li>Implemented for all window geometries, but slow for complex windows.</li>
</ul></li>
<li><span class="arg-text">“periodic”</span>: (aka toroidal) is only defined for rectangular windows.</li>
<li><span class="arg-text">“none”</span>: This uncorrected estimate is biased and should not be used for data analysis, <em>unless</em> you have an extremely large point pattern (more than 100,000 points).</li>
<li><span class="arg-text">“best”</span>: Selects Ripley’s <span class="arg-text">“isotropic”</span> correction for a rectangular or polygonal window, and the <span class="arg-text">“translation”</span> correction for masks.</li>
<li><span class="arg-text">“good”</span>: Selects the best edge correction that can be computed in a reasonable time. This is the same as <span class="arg-text">“best”</span> for datasets with fewer than 3000 points; otherwise the selected edge correction is <span class="arg-text">“border”</span>, unless there are more than 100,000 points, when it is <span class="arg-text">“none”</span>.</li>
</ul></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat.explore::Kest}</span><br>
<a href="_resources/Geospatial-Point-Patterns.resources/test-kfunc-ex-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="_resources/Geospatial-Point-Patterns.resources/test-kfunc-ex-1.png" class="img-fluid" width="432"></a></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"pp3_df"</span>, <span class="at">package =</span> <span class="st">"isdas"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">owin</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>pp3.ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(pp3_df, <span class="at">W =</span> W)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>k_pattern3 <span class="ot">&lt;-</span> <span class="fu">Kest</span>(pp3.ppp, <span class="at">correction =</span> <span class="st">"none"</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k_pattern3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Plot of <span class="var-text">pp3.ppp</span> shown earlier</li>
<li><span class="math inline">\(\hat K(r) \gt K(r)\)</span> at a smaller scale which indicates clustering,</li>
<li>But also, <span class="math inline">\(\hat K(r) \lt K(r)\)</span> at a larger scale which indicates regularity.</li>
</ul></li>
</ul></li>
<li><p><u>L-Function</u></p>
<ul>
<li><p>Transformation for the K-Function<br>
<span class="math display">\[
L(r) = \sqrt \frac{K(r)}{\pi}
\]</span></p></li>
<li><p>K-Function Issues</p>
<ul>
<li>Non-Linearity: For a Poisson process (complete spatial randomness), <span class="math inline">\(K=\pi r^2\)</span>, which is a quadratic function. This makes it harder to visually assess deviations from CSR.</li>
<li>Scale Dependency: The K-function grows with r, making it difficult to compare patterns at different scales.</li>
</ul></li>
<li><p>L-Function Advantages</p>
<ul>
<li>Linear: Easier to visually assess</li>
<li>Scale Independent: Can compare point patterns at different scales</li>
</ul></li>
<li><p>Guidelines</p>
<ul>
<li><span class="math inline">\(L(r) \gt r\)</span> : The point pattern exhibits <em>clustering</em> at distance <span class="math inline">\(r\)</span>.</li>
<li><span class="math inline">\(L(r) \approx r\)</span> : The point pattern is <em>random</em> at distance <span class="math inline">\(r\)</span>.</li>
<li><span class="math inline">\(L(r) \lt r\)</span> : The point pattern exhibits <em>inhibition (repulsion)</em> at distance <span class="math inline">\(r\)</span>.</li>
</ul></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat.explore::Lest}</span></p>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 39.9%;justify-content: center;">
<p><a href="_resources/Geospatial-Point-Patterns.resources/tests-lfunc-ex1-1.png" class="lightbox" data-gallery="lfunc-ex1-1"><img src="_resources/Geospatial-Point-Patterns.resources/tests-lfunc-ex1-1.png" class="img-fluid" width="232"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 60.1%;justify-content: center;">
<p><a href="_resources/Geospatial-Point-Patterns.resources/tests-lfunc-ex1-2.png" class="lightbox" data-gallery="lfunc-ex1-1"><img src="_resources/Geospatial-Point-Patterns.resources/tests-lfunc-ex1-2.png" class="img-fluid" width="350"></a></p>
</div>
</div>
</div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cells)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">Lest</span>(cells)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Basic example from the docs</li>
<li>At small to intermediate distance, there is regularity, but at further distances, the pattern is random.
<ul>
<li>i.e.&nbsp;The distance between points is roughly the same, but the overall pattern is random</li>
</ul></li>
<li>Border (Reduced Sample), Translation, and Isotropic edge corrections are shown</li>
</ul></li>
</ul></li>
<li><p><u>Pair Correlation (<span class="math inline">\(g\)</span>)</u></p>
<ul>
<li><p>Contains contributions only from interpoint distances equal to <span class="math inline">\(r\)</span> unlike <span class="math inline">\(K\)</span> which contains contributions of all distances less than and equal to <span class="math inline">\(r\)</span>.</p></li>
<li><p>As a function of K,<br>
<br>
<span class="math display">\[
g(r) = \frac{K'(r)}{2\pi r}
\]</span></p>
<ul>
<li>Where <span class="math inline">\(K'(r)\)</span> is the first derivative of the K-Function</li>
<li>In practice, this is estimated a little differently with a few different methods available.</li>
<li>In another derviation, <span class="math inline">\(g(r)\)</span> is shown to be the probability of observing a pair of points of the process separated by a distance <span class="math inline">\(r\)</span>, divided by the corresponding probability for a Poisson process.</li>
</ul></li>
<li><p>Empirically<br>
<span class="math display">\[
\begin{align}
&amp;\hat g(r) = \frac{|W|}{2 \pi r n(n-1)} \sum_{i=1}^n \sum_{j=1 \\ j\ne 1}^n \kappa_h (r-d_{ij})e_{ij}(r) \\
&amp;\text{where} \;\; \kappa_h(x) = \frac{1}{h}\kappa \left(\frac{x}{h}\right)
\end{align}
\]</span></p>
<ul>
<li><span class="math inline">\(d_{ij}\)</span> is the distance between the i<sup>th</sup> and j<sup>th</sup> data point</li>
<li><span class="math inline">\(e_{ij}(r)\)</span> is teh correction weight</li>
<li><span class="math inline">\(\kappa_h\)</span> is th smoothing kernel and <span class="math inline">\(h\)</span> is the bandwidth</li>
</ul></li>
<li><p><u>Epanechnikov Kernel</u> with half-width, <span class="math inline">\(w\)</span><br>
<span class="math display">\[
ε_w(x) = \frac{3}{4w} \left(1-\frac{x^2}{w^2}\right)_+, \quad (x)_+ = \max(0,x)
\]</span></p>
<ul>
<li>A quadratic function truncated to <span class="math inline">\([-w,w]\)</span> with its standard deviation, <span class="math inline">\(h = w/\sqrt{5}\)</span>.</li>
<li>A large <span class="math inline">\(h\)</span> reduces variance but <span class="math inline">\(\hat g\)</span> will be over-smoothed. A small <span class="math inline">\(h\)</span> will have high variance which means an overly-erratic <span class="math inline">\(\hat g\)</span>.</li>
<li>Typical choice for Pair Correlation. Haven’t seen any of the other possible kernels mentioned anywhere in the spatstat book or docs.</li>
<li>Stoyan’s Rule of Thumb:<br>
<span class="math display">\[
\begin{align}
&amp;h = \frac{c'}{\sqrt{\hat \lambda}} \\
&amp;\text{where} \; 0.045 \le c' \le 0.090
\end{align}
\]</span>
<ul>
<li>The choice of denominator in the intensity estimate will also be important.</li>
<li>Default: <span class="math inline">\(c' = 0.067\)</span></li>
</ul></li>
</ul></li>
<li><p>Guidelines</p>
<ul>
<li>Range: [0, <span class="math inline">\(\infty\)</span>]</li>
<li><span class="math inline">\(g(r) \gt 1\)</span> : The interpoint distance is more frequent than expected for a completely random pattern, which suggests clustering</li>
<li><span class="math inline">\(g(r) = 1\)</span> : CRS</li>
<li><span class="math inline">\(g(r) \lt 1\)</span> : The interpoint distances equal to r are less frequent than would be expected for a completely random process, so this suggests regularity.</li>
</ul></li>
<li><p><span style="color: #990000">{spatstat.explore::pcf.fv}</span></p>
<ul>
<li><p>Takes the <code>Kest</code> object and applies a smoothing function so that a derivative can be taken.</p></li>
<li><p>Best for larger datasets</p></li>
<li><p>Takes other arguments for <span style="color: #990000">{stats::smooth.spline}</span></p></li>
<li><p><span class="arg-text">method =</span> - Method “c” (default) has the best all-around performance. Methods “b” to “d” offer improved performance at small distances <span class="math inline">\(r\)</span>.</p>
<ul>
<li><span class="arg-text">“a”</span> applies the smooth to <span class="math inline">\(K(r)\)</span>, estimates its derivative, and plugs it into the K-based equation</li>
<li><span class="arg-text">“b”</span> applies the smooth to <span class="math inline">\(K(r)/(2\pi r)\)</span>, etc., etc.</li>
<li><span class="arg-text">“c”</span> applies the smooth to <span class="math inline">\(K(r)/(\pi r^2)\)</span>, etc., etc.</li>
<li><span class="arg-text">“d”</span> applies the smooth to <span class="math inline">\(\sqrt{K(r)}\)</span>, etc., etc.</li>
</ul></li>
</ul></li>
<li><p><span style="color: #990000">{spatstat.explore::pcf.ppp}</span></p>
<ul>
<li>Takes a <code>ppp</code> object and applies the empircal formula above</li>
<li><span class="arg-text">divisor = “r”</span> applies the empirical formula asis. This formula has trouble with values of <span class="math inline">\(r\)</span> that are close to 0 as they cause <span class="math inline">\(g(r)\)</span> to go to infinity.
<ul>
<li>If pair correlations at small distances are important, use <span class="arg-text">“d”</span>.</li>
</ul></li>
<li>There are also the arguments: <span class="arg-text">kernel</span>, <span class="arg-text">bw</span>, <span class="arg-text">stoyan</span>, <span class="arg-text">correction</span>, etc., but from my readings it seems best to stick with the defaults unless you spot something nonsensical in the output.</li>
</ul></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat}</span> book, p.&nbsp;228</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">With a K-Function Object</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">With a ppp Object</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="quarto-layout-panel" data-layout-nrow="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/spdep-corr-pair-shapley-1.png" class="lightbox" data-gallery="pair-corr-ex1" title="Shapley"><img src="_resources/Geospatial-Point-Patterns.resources/spdep-corr-pair-shapley-1.png" class="img-fluid figure-img" width="332" alt="Shapley"></a></p>
<figcaption>Shapley</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/spdep-corr-pair-kest-1.png" class="lightbox" data-gallery="pair-corr-ex1" title="Pair Correlation"><img src="_resources/Geospatial-Point-Patterns.resources/spdep-corr-pair-kest-1.png" class="img-fluid figure-img" width="332" alt="Pair Correlation"></a></p>
<figcaption>Pair Correlation</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">unmark</span>(shapley))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kest</span>(shapley)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">pcf</span>(K, <span class="at">spar =</span> <span class="fl">0.5</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><span class="var-text">shapley</span> is an astronomical dataset showing galaxy concentration</li>
<li><span class="arg-text">spar</span> is the smoothing parameter for <span style="color: #990000">{stats::smooth.spline}</span></li>
<li><span class="math inline">\(g\)</span> stays &gt;1 for the entire range of <span class="math inline">\(r\)</span> which suggests clustering</li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/spdep-corr-pair-ppp-1.png" class="lightbox" data-gallery="pair-corr-ex1" title="Pair Correlation"><img src="_resources/Geospatial-Point-Patterns.resources/spdep-corr-pair-ppp-1.png" class="img-fluid figure-img" width="332" alt="Pair Correlation"></a></p>
<figcaption>Pair Correlation</figcaption>
</figure>
</div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">pcf</span>(cells)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>See the L-Function example (previous section) for a plot of <span class="var-text">cells</span></li>
<li>At a distance <span class="math inline">\(0.12 \le r \le 0.21\)</span> (using the Ripley edge correction), <span class="math inline">\(g(r) \ge 1\)</span> which suggests clustering.</li>
<li>Don’t see <span class="math inline">\(g(r)\)</span> going off to infinity as small <span class="math inline">\(r\)</span> distances, so using <span class="arg-text">divisor = “d”</span> is unnecessary.</li>
<li>Both are appropriate, but the Ripley edge correction shows a greater effect than the Translation correction. See <a href="../qmd/geospatial-point-patterns.html#sec-geo-ptpat-depfun-spcor" style="color: green">K-Function</a> &gt;&gt; Edge Correction Methods for more details.</li>
</ul>
</div>
</div>
</div></li>
</ul></li>
</ul>
</section>
<section id="sec-geo-ptpat-depfun-uncert" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="sec-geo-ptpat-depfun-uncert">Uncertainty</h3>
<ul>
<li><p><u>Simulation Envelopes</u></p>
<ul>
<li><p>Simulation makes it possible to calculate the variance of the expected value under the null hypothesis, i.e.&nbsp;an uncertainty measurement. While it doesn’t give you a p-value, you can obtain a acceptance (of the Null) region.</p></li>
<li><p>Available for any summary statistic or dependence function</p></li>
<li><p>Process: Plug the average intensity of the dataset, <span class="math inline">\(\hat \lambda\)</span>, (from the <span class="arg-text">ppp</span> object) into random number generating function (<code>rpoispp</code> which is something like <code>rpois</code>) to get the <em>Null Landscape</em>. Then, use those generated values as inputs to <code>Gest</code>, <code>Fest</code>, or <code>Kest</code> to get a curve at multiple <span class="math inline">\(r\)</span> values. Repeat many times to get your Null distribution. If your empirical <span class="math inline">\(\hat G\)</span>, <span class="math inline">\(\hat F\)</span>, or <span class="math inline">\(\hat K\)</span> function falls within the ribbon of simulated Null values (aka <strong>Simulation Envelope</strong>), then the pattern is random.</p></li>
<li><p>If the graph of the estimated function for the data transgresses these limits, it is statistically significant with a p-value of <span class="math inline">\(1/(m+1)\)</span> where <span class="math inline">\(m\)</span> is the number of simulated patterns.</p>
<ul>
<li>Taking m = 19 gives a test with significance level 0.05.</li>
</ul></li>
<li><p><span style="color: #990000">{spatstat.explore::envelope}</span></p>
<ul>
<li><span class="arg-text">global = TRUE</span> says calculate global CIs instead of pointwise CIs (See Block Variance caveat)</li>
</ul></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat}</span> book, p.&nbsp;235</p>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/spdep-uncert-env-ex1-swp-1.png" class="lightbox" data-gallery="uncert-env-ex1" title="Swedish Pines"><img src="_resources/Geospatial-Point-Patterns.resources/spdep-uncert-env-ex1-swp-1.png" class="img-fluid figure-img" width="176" alt="Swedish Pines"></a></p>
<figcaption>Swedish Pines</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/spdep-uncert-env-ex1-kest-1.png" class="lightbox" data-gallery="uncert-env-ex1" title="K-Function"><img src="_resources/Geospatial-Point-Patterns.resources/spdep-uncert-env-ex1-kest-1.png" class="img-fluid figure-img" width="254" alt="K-Function"></a></p>
<figcaption>K-Function</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/spdep-uncert-env-ex1-lest-1.png" class="lightbox" data-gallery="uncert-env-ex1" title="L-Function"><img src="_resources/Geospatial-Point-Patterns.resources/spdep-uncert-env-ex1-lest-1.png" class="img-fluid figure-img" width="254" alt="L-Function"></a></p>
<figcaption>L-Function</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>swp <span class="ot">&lt;-</span> <span class="fu">rescale</span>(swedishpines)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(swp)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>env_k_swp <span class="ot">&lt;-</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">envelope</span>(<span class="at">Y =</span> swp,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">fun =</span> Kest, </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">nsim =</span> <span class="dv">19</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">global =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(env_k_swp) </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>env_l_swp <span class="ot">&lt;-</span> </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">envelope</span>(<span class="at">Y =</span> swp,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">fun =</span> Lest, </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">nsim =</span> <span class="dv">19</span>,</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">global =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(env_l_swp)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>env_l_swp</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simultaneous critical envelopes for L(r)</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; and observed value for ‘swp’</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Edge correction: “iso”</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Obtained from 19 simulations of CSR</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Envelope based on maximum deviation of L(r) from null value for CSR (known exactly)</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Alternative: two.sided</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Significance level of simultaneous Monte Carlo test: 1/20 = 0.05</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ...........................................................</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Math.label     Description                            </span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; r    r              distance argument r                    </span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; obs  hat(L)[obs](r) observed value of L(r) for data pattern</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theo L[theo](r)     theoretical value of L(r) for CSR      </span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lo   hat(L)[lo](r)  lower critical boundary for L(r)       </span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; hi   hat(L)[hi](r)  upper critical boundary for L(r)       </span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ...........................................................</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Default plot formula:  .~r</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; where “.” stands for ‘obs’, ‘theo’, ‘hi’, ‘lo’</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Columns ‘lo’ and ‘hi’ will be plotted as shading (by default)</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Recommended range of argument r: [0, 2.4]</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Available range of argument r: [0, 2.4]</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Unit of length: 1 metre</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Using the L-Function stablilizes the variance and produces a more powerful test. The function escapes the envelope, so the Null (CSR) is rejected at <span class="math inline">\(\alpha = 0.05\)</span> .</li>
<li>Inhibition is suggested at <span class="math inline">\(0.6 \le r \le 1.0\)</span></li>
<li><code>rescale</code> is used to convert the coordinates to a standard unit of length, e.g.&nbsp;unit like 0.1 meters to the base unit meters.</li>
</ul></li>
</ul></li>
<li><p><u>Loh’s Bootstrap</u></p>
<ul>
<li><span style="color: #990000">{spatstat.explore::lohboot}</span></li>
<li>Gives a 95% CI for a correlation function</li>
<li>Available functions: “pcf”, “Kest”, “Lest”, “pcfinhom”, “Kinhom”, “Linhom”, “Kcross”, “Lcross”, “Kdot”, “Ldot”, “Kcross.inhom”, “Lcross.inhom”</li>
<li>For global CIs instead of pointwise CIs (see Block Variance caveat) for <span class="math inline">\(K\)</span> and <span class="math inline">\(L\)</span>-Functions, which is what you want, <span class="arg-text">global = TRUE</span> needs set:
<ul>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat}</span> book, p.&nbsp;232</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Lg <span class="ot">&lt;-</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lohboot</span>(swp, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>          Lest, </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">global =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>Kg <span class="ot">&lt;-</span> <span class="fu">eval.fv</span>(pi <span class="sc">*</span> Lg<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul></li>
<li>When the intensity of the point process is unknown, the bootstrap error estimate is larger than it should be. When the K function is used, an adjustment procedure has been proposed in Loh (2010) that is used if <span class="arg-text">Vcorrection=TRUE</span></li>
<li>Beware of CIs that look too narrow
<ul>
<li>This may occur because the point pattern has a hard core (the true pair correlation function is zero for certain values of distance) or because of an optical illusion when the function is steeply sloping (remember the width of the confidence bands should be measured vertically)</li>
</ul></li>
</ul></li>
<li><p><u>Block Variance</u></p>
<ul>
<li><span style="color: #990000">{spatstat.explore::varblock}</span></li>
<li>Gives a 95% CI for a any summary statistic or dependence function</li>
<li>Process: The estimate from block B is computed by finding the subset of X consisting of points that fall inside B, and applying fun to these points, by calling fun(X[B]).</li>
<li>“An important caveat is that these are pointwise calculations (i.e.&nbsp;performed separately for each value of distance <span class="math inline">\(r\)</span>) yielding pointwise confidence intervals (i.e.&nbsp;valid only for a single value of <span class="math inline">\(r\)</span> at a time). Our confidence that the true <span class="math inline">\(K\)</span>-function lies entirely inside the grey shaded region, over <em>all</em> values of <span class="math inline">\(r\)</span>, is vastly less than 95%.” (<span style="color: #990000">{spatstat}</span> book, p.&nbsp;231)</li>
</ul></li>
</ul>
</section>
</section>
<section id="sec-geo-ptpat-int" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sec-geo-ptpat-int">Intensity</h2>
<section id="sec-geo-ptpat-int-typ" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="sec-geo-ptpat-int-typ">Types</h3>
<ul>
<li><p><u>Average Intensity</u></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rescale</span>(swedishpines)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>lam <span class="ot">&lt;-</span> <span class="fu">intensity</span>(X)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># standard error</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>sdX <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(lam<span class="sc">/</span><span class="fu">area</span>(<span class="fu">Window</span>(X)))<span class="er">)</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.08777</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><code>rescale</code> is used to convert the coordinates to a standard unit of length, e.g.&nbsp;unit like 0.1 meters to the base unit meters.</li>
<li>The standard error is in points per square meter in this case
<ul>
<li>Assumes homogeneous intensity</li>
</ul></li>
</ul></li>
<li><p><u>Per Quadrat</u></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>swp <span class="ot">&lt;-</span> <span class="fu">rescale</span>(swedishpines)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Q3 <span class="ot">&lt;-</span> <span class="fu">quadratcount</span>(swp, <span class="at">nx =</span> <span class="dv">3</span>, <span class="at">ny =</span> <span class="dv">3</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">intensity</span>(Q3)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              x</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; y             [0,3.2) [3.2,6.4) [6.4,9.6]</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [6.67,10]   0.75000   0.56250   0.65625</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [3.33,6.67) 0.75000   1.03125   0.84375</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [0,3.33)    0.46875   0.56250   1.03125</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>L3 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">intensity</span>(Q3))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># standard error of the mean</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>sem <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(L3)<span class="sc">/</span>(<span class="fu">length</span>(L3)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.07118</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Using tesselized quadrats</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="fu">hextess</span>(swp, <span class="at">s =</span> <span class="dv">1</span>)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>hQ <span class="ot">&lt;-</span> <span class="fu">quadratcount</span>(swp, <span class="at">tess =</span> H)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="fu">intensity</span>(hQ, <span class="at">image =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Standard Error of the Mean assumes that the counts in each quadrat are independent (from other quadrat counts)</li>
<li><code>hextess</code> produces hex-shaped quadrats. <span class="arg-text">s</span> is the side length of the hexagons (e.g.&nbsp;1 meter). <span class="arg-text">image = TRUE</span> allows <code>plot</code> to create a sort of hex-shaped celled heatmap of the intensities.
<ul>
<li><p>Since the side-length is required, these have to be fixed-size tesselations which is supported by the figure in the book</p></li>
<li><p>“To obtain comparable results from quadrat counting with hexagonal tiles, the tile size should be chosen to match the bandwidth of the kernel smoother.” (<span style="color: #990000">{spatstat}</span> book, p.&nbsp;193</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> <span class="fl">0.5</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>(s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">24</span><span class="sc">/</span><span class="dv">5</span>) <span class="sc">*</span> sig)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.095</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>ht<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">hextess</span>(<span class="fu">as.owin</span>(qk), s)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>hq<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">intensity</span>(<span class="fu">quadratcount</span>(qk, <span class="at">tess=</span>ht<span class="fl">.5</span>), <span class="at">image=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><code>sig &lt;- 0.5</code> was somewhat arbitrary. It’s somewhat in the middle of the results from the sigma calculating methods (e.g.&nbsp;<code>bw.diggle</code>)</li>
</ul></li>
</ul></li>
</ul></li>
<li><p><u>Relative Intensity</u></p>
<ul>
<li>A spatial case-control dataset gives the spatial locations of a set of disease cases, and of a separate set of controls (notionally a sample from the population at risk of the disease).</li>
<li>If the disease risk per head of population does not depend on spatial location, then we would expect the spatially varying intensities of these two point processes to be proportional</li>
</ul></li>
<li><p><u>Weighted Intensity</u></p>
<ul>
<li><p><span class="ribbon-highlight">Example</span></p>
<ul>
<li>When there are multiple disease cases at the same residence, it is then appropriate to weight each residential location by the number of cases.</li>
<li>Intensity would be the average total number of cases per unit area, not the number of affected residences per unit area.</li>
</ul></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat}</span> book, p.&nbsp;174</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>vols <span class="ot">&lt;-</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">marks</span>(finpines),</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>       (pi<span class="sc">/</span><span class="dv">12</span>) <span class="sc">*</span> height <span class="sc">*</span> (diameter<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>Dvol <span class="ot">&lt;-</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">density</span>(finpines, </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">weights =</span> vols, </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">sigma =</span> bw.ppl)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">intensity</span>(finpines, <span class="at">weights =</span> vols)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.001274</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Volume-weighted intensity is the average standing volume of wood per unit area of forest.</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="sec-geo-ptpat-int-covdep" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="sec-geo-ptpat-int-covdep">Covariate Dependence</h3>
<ul>
<li><p><u>EDA</u></p>
<ul>
<li><p><span class="ribbon-highlight">Example</span>: Tesselation by Covariate (<span style="color: #990000">{spatstat}</span> book p.&nbsp;178)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Tesselation by Elevation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Intensity By Elevation</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p><a href="_resources/Geospatial-Point-Patterns.resources/inhom-eda-ex1-ppp-1.png" class="lightbox" data-gallery="inhom-eda-1"><img src="_resources/Geospatial-Point-Patterns.resources/inhom-eda-ex1-ppp-1.png" class="img-fluid" width="532"></a></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(bei) <span class="co"># also loads bei.extra</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><span class="var-text">bei</span> is tropical rainforest data with Beilschmiedia tree locations</li>
<li><span class="var-text">bei.extra</span> has elevation and slope gradation variables</li>
</ul>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p><a href="_resources/Geospatial-Point-Patterns.resources/inhom-eda-ex1-text-1.png" class="lightbox" data-gallery="inhom-eda-1"><img src="_resources/Geospatial-Point-Patterns.resources/inhom-eda-ex1-text-1.png" class="img-fluid" width="682"></a></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>tess_bei <span class="ot">&lt;-</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantess</span>(<span class="at">M =</span> bei,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">Z =</span> bei.extra<span class="sc">$</span>elev,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">4</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">textureplot</span>(tess_bei)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">quadratcount</span>(bei, <span class="at">tess =</span> tess_bei)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tile</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [120,140] (140,144] (144,150] (150,159] </span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       714       883      1344       663 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Elevation is binned into four quantiles and four tiles are created with each associated to an elevation bin.</li>
<li>Since the four regions have equal area, the counts should be approximately equal if there is a uniform density of trees — which they are not.</li>
</ul>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p><a href="_resources/Geospatial-Point-Patterns.resources/inhom-eda-ex1-bar-1.png" class="lightbox" data-gallery="inhom-eda-1"><img src="_resources/Geospatial-Point-Patterns.resources/inhom-eda-ex1-bar-1.png" class="img-fluid" width="382"></a></p>
<div class="sourceCode" id="annotated-cell-30"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-30-1" class="code-annotation-target"><a href="#annotated-cell-30-1" aria-hidden="true" tabindex="-1"></a>bks_elev <span class="ot">&lt;-</span></span>
<span id="annotated-cell-30-2"><a href="#annotated-cell-30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">seq.int</span>(<span class="fu">floor</span>(<span class="fu">min</span>(bei.extra<span class="sc">$</span>elev)), </span>
<span id="annotated-cell-30-3"><a href="#annotated-cell-30-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ceiling</span>(<span class="fu">max</span>(bei.extra<span class="sc">$</span>elev)), </span>
<span id="annotated-cell-30-4"><a href="#annotated-cell-30-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">by =</span> <span class="dv">5</span>)</span>
<span id="annotated-cell-30-5"><a href="#annotated-cell-30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-30-6"><a href="#annotated-cell-30-6" aria-hidden="true" tabindex="-1"></a>bei.extra<span class="sc">$</span>elev <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-30-7" class="code-annotation-target"><a href="#annotated-cell-30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cut</span>(<span class="at">breaks =</span> bks_elev,</span>
<span id="annotated-cell-30-8"><a href="#annotated-cell-30-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">include.lowest =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-30-9" class="code-annotation-target"><a href="#annotated-cell-30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tess</span>(<span class="at">image =</span> _) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-30-10" class="code-annotation-target"><a href="#annotated-cell-30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quadratcount</span>(bei,</span>
<span id="annotated-cell-30-11"><a href="#annotated-cell-30-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">tess =</span> _) <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-30-12" class="code-annotation-target"><a href="#annotated-cell-30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">intensity</span>() <span class="sc">|&gt;</span></span>
<span id="annotated-cell-30-13"><a href="#annotated-cell-30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">barplot</span>(<span class="at">xlab =</span> <span class="st">"Elevation"</span>,</span>
<span id="annotated-cell-30-14"><a href="#annotated-cell-30-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Intensity"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-30" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="1" data-code-annotation="1">The range of elevations is divided into intervals of equal width</span>
</dd>
<dt data-target-cell="annotated-cell-30" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="7" data-code-annotation="2">The elevations in the image object get binned according to the intervals</span>
</dd>
<dt data-target-cell="annotated-cell-30" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="9" data-code-annotation="3">Tiles are created according to the binned elevations</span>
</dd>
<dt data-target-cell="annotated-cell-30" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="10" data-code-annotation="4">The number of trees for each tile is counted</span>
</dd>
<dt data-target-cell="annotated-cell-30" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="12" data-code-annotation="5">Average intensity is calculated for each tile and displayed in a bar graph.</span>
</dd>
</dl>
<ul>
<li>The non-uniform distribution implies inhomogeneity with intensity peaking at high elevations.</li>
</ul>
</div>
</div>
</div></li>
<li><p>Relative Distribution Function (<span class="math inline">\(\hat \rho\)</span>)<br>
<br>
<span class="math display">\[
\lambda(u) = \rho(Z(u))
\]</span></p>
<ul>
<li><p>Tells us how the intensity of points depends on the value of the covariate. <span class="math inline">\(\hat \rho\)</span> is a non-parametric estimate of intensity that assumes a smooth function of the covariate is equal to intensity.</p></li>
<li><p>If a covariate is predictive of intensity, then it should agree pretty well with the kernel density estimate.</p></li>
<li><p>To investigate two covariates and whether they jointly predict intensity, use <code>with(bei.extra, rho2hat(bei, grad, elev))</code></p></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat}</span> book, p.180</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Calculate “rho-hat”</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Validate</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p><a href="_resources/Geospatial-Point-Patterns.resources/inhom-rho-ex1-1.png" class="lightbox" data-gallery="rhat-ex-1"><img src="_resources/Geospatial-Point-Patterns.resources/inhom-rho-ex1-1.png" class="img-fluid" width="482"></a></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rhohat</span>(bei, bei.extra<span class="sc">$</span>elev) <span class="sc">|&gt;</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">xlab =</span> <span class="st">"Elevation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>These are 95% confidence bands that assumes an <em>inhomogeneous</em> Poisson point process</li>
<li>The plot indicates that the Beilschmiedia trees are more likely to be found at elevations between 135 and 155 meters than would be expected if the intensity was constant (at average intensity, <span class="math inline">\(\bar \rho\)</span>).</li>
<li>Rug shows the number of observed trees at each value of the elevation</li>
<li>There are options for various rho estimators, and smoothing methods available. See docs and book for details.</li>
</ul>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="quarto-layout-panel" data-layout-nrow="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/inhom-rho-ex1-2.png" class="lightbox" data-gallery="rhat-ex-1" title="Pairs Plot"><img src="_resources/Geospatial-Point-Patterns.resources/inhom-rho-ex1-2.png" class="img-fluid figure-img" width="532" alt="Pairs Plot"></a></p>
<figcaption>Pairs Plot</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/inhom-rho-ex1-3.png" class="lightbox" data-gallery="rhat-ex-1" title="Difference in Estimates"><img src="_resources/Geospatial-Point-Patterns.resources/inhom-rho-ex1-3.png" class="img-fluid figure-img" width="532" alt="Difference in Estimates"></a></p>
<figcaption>Difference in Estimates</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pred_elev <span class="ot">&lt;-</span> <span class="fu">predict</span>(rh_bei_elev)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>kden <span class="ot">&lt;-</span> <span class="fu">density</span>(bei, <span class="dv">50</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(pred_elev, kden)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">eval.im</span>(kden <span class="sc">-</span> pred_elev))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The goal of these plots is to determine whether the covariate is a good predictor of intensity. If it isn’t, then maybe that line graph shouldn’t be believed too strongly.</li>
<li>The matrix scatterplot using <code>pairs</code> should show points centered around the diagonal. Doesn’t really look like that to me, but the author calls it a “reasonable appoximation.”
<ul>
<li>The two plots are unnecessary as both show the same thing, but I guess thats the only plotting option.</li>
</ul></li>
<li>The density map shows the difference between the <span class="math inline">\(\hat \rho\)</span> intensity estimates and the kernel density estimates. The whole area should be close to zero. Given the scale of both the intensity predictions from the line chart and the scale of the differences, it doesn’t look like a good fit to me. Again, though, the author calls it a “reasonable approximation.”
<ul>
<li>The palette is completely inappropriate as it should be diverging. Maybe that can be changed, but I didn’t look into it. This palette made interpretation difficult.</li>
</ul></li>
<li>The author also said that these same techniques would show that the gradation covariate is a bad predictor of intensity. I didn’t include the analysis here, but I didn’t see much difference at all between the results of elevation and gradation. The whole validation part of this exercise has been confusing.
<ul>
<li>Speaking of confusing, where did <span class="arg-text">sigma = 50</span> in the <code>density</code> function come from? ¯\_(ツ)_/¯ The book doesn’t say.</li>
</ul></li>
</ul>
</div>
</div>
</div></li>
</ul></li>
</ul></li>
<li><p><u>Tests</u></p>
<ul>
<li>Formal tests can help determine the strength of visual analysis</li>
<li>A more probing analysis than these tests is to choose a class of parametric models for the intensity, and test hypotheses about the model parameters (i.e.&nbsp;covariate coefficients).</li>
<li>Hypotheses
<ul>
<li>H<sub>0</sub>: Intensity does not depend on <span class="math inline">\(Z\)</span>.</li>
<li>H<sub>a</sub>: Intensity does depend on <span class="math inline">\(Z\)</span> in some unspecified way</li>
</ul></li>
<li><u>Quadrat-based <span class="math inline">\(\chi^2\)</span> Test</u>
<ul>
<li><p>This test should be used in preference to the ‘naive’ <span class="math inline">\(\chi^2\)</span> test in <a href="../qmd/geospatial-point-patterns.html#sec-geo-ptpat-csrt" style="color: green">CSR Tests</a> whenever we have good grounds for suspecting that the covariate <span class="math inline">\(Z\)</span> has an influence on the intensity of the point process.</p>
<ul>
<li>Although the two tests have the same general form, the test based on ranges of values of the covariate is more sensitive and therefore has greater statistical power.</li>
</ul></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat}</span> book, p.&nbsp;184</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(bei) <span class="co"># also loads bei.extra</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>tess_bei <span class="ot">&lt;-</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantess</span>(<span class="at">M =</span> bei,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">Z =</span> bei.extra<span class="sc">$</span>elev,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">4</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">quadratcount</span>(bei, <span class="at">tess =</span> tess_bei)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tile</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [120,140] (140,144] (144,150] (150,159] </span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       714       883      1344       663 </span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="fu">quadrat.test</span>(bei, <span class="at">tess =</span> tess_bei)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Chi-squared test of CSR using quadrat counts</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  bei</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X2 = 319.95, df = 3, p-value &lt; 2.2e-16</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: two.sided</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Quadrats: 4 tiles (levels of a pixel image)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><span class="var-text">bei</span> is tropical rainforest data with Beilschmiedia tree locations</li>
<li><span class="var-text">bei.extra</span> has elevation and slope gradation variables</li>
<li>Because of the large counts in these regions, we can probably ignore concerns about independence, and conclude that the trees are not uniform in their intensity.
<ul>
<li>Also see <a href="../qmd/geospatial-point-patterns.html#sec-geo-ptpat-csrt" style="color: green">CSR Tests</a> &gt;&gt; Quadrat-based <span class="math inline">\(\chi^2\)</span> Test &gt;&gt; Reasons for Rejection of the Null</li>
</ul></li>
<li>With the gradiation covariate, the Null was also rejected, so again not sure what he was talking about in that <span class="math inline">\(\hat \rho\)</span> section</li>
</ul></li>
</ul></li>
<li><u>Cumulative Distribution Tests</u>
<ul>
<li><p>Tests whether the values of the covariate at the <em>observed</em> locations are a random sample from the distribution of the variable values at <em>all</em> locations in the window.</p>
<ul>
<li>If values of the covariate are a random sample (H<sub>0</sub>), then the test indicates there is no dependence of intensity on this variable.</li>
</ul></li>
<li><p>Also see <a href="../qmd/distributions.html#sec-distr-tests" style="color: green">Distributions &gt;&gt; Tests</a></p></li>
<li><p>If the discretisation is severe, or if the covariate is an intrinsically discrete-valued variable or a factor, the Kolmogorov-Smirnov test is not supported by theory (and is ineffective because of tied values). Use the <span class="math inline">\(\chi^2\)</span> test instead.</p></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat}</span> book, p.&nbsp;185<br>
<a href="_resources/Geospatial-Point-Patterns.resources/int-test-cdf-ex1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="_resources/Geospatial-Point-Patterns.resources/int-test-cdf-ex1-1.png" class="img-fluid" width="432"></a></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>cdf_elev <span class="ot">&lt;-</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cdf.test</span>(<span class="at">X =</span> bei, <span class="at">covariate =</span> bei.extra<span class="sc">$</span>elev)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Spatial Kolmogorov-Smirnov test of CSR in two dimensions</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data: covariate 'elev' evaluated at points of 'bei'</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    and transformed to uniform distribution under CSR</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; D = 0.11, p-value &lt;2e-16</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cdf_elev, <span class="at">xlab =</span> <span class="st">"Elevation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><span class="arg-text">type = “cvm”</span> (Cramer-von Mises) and <span class="arg-text">“ad”</span> (Anderson-Darling) also available</li>
<li>Null is strongly rejected, so this test indicates intensity is dependent on <span class="var-text">Elevation</span></li>
<li>With the gradiation covariate, the Null was also rejected, so again, again not sure what he was talking about in that <span class="math inline">\(\hat \rho\)</span> section</li>
<li>There’s also a <span class="arg-text">style = “PP”</span> (kind of a observed vs predicted plot) and <span class="arg-text">style = “QQ”</span> which is a Q-Q plot</li>
</ul></li>
</ul></li>
<li><u>Berman’s Tests</u>
<ul>
<li><p>These tests have better performance than the Kolmogorov-Smirnov test against certain alternatives</p></li>
<li><p>Types</p>
<ul>
<li>Z<sub>1</sub> (Lawson-Waller): Based on the sum of the the covariate values at all the observed locations</li>
<li>Z<sub>2</sub>: Based on the sum of the G-Function of covariate values at all the observed locations</li>
</ul></li>
<li><p><span class="ribbon-highlight">Example</span>:</p>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/int-test-berm-ex1-1.png" class="lightbox" data-gallery="berm-ex1" title="Z1"><img src="_resources/Geospatial-Point-Patterns.resources/int-test-berm-ex1-1.png" class="img-fluid figure-img" width="332" alt="Z1"></a></p>
<figcaption>Z1</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/int-test-berm-ex1-2.png" class="lightbox" data-gallery="berm-ex1" title="Z2"><img src="_resources/Geospatial-Point-Patterns.resources/int-test-berm-ex1-2.png" class="img-fluid figure-img" width="332" alt="Z2"></a></p>
<figcaption>Z2</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>berm_bei <span class="ot">&lt;-</span> <span class="fu">berman.test</span>(<span class="at">X =</span> bei, <span class="at">covariate =</span> bei.extra<span class="sc">$</span>elev)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Berman Z1 test of CSR in two dimensions</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     </span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data: covariate 'elev' evaluated at points of 'bei'</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Z1 = -0.73, p-value = 0.5</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(berm_bei)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>berm_bei_2 <span class="ot">&lt;-</span> </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">berman.test</span>(<span class="at">X =</span> bei, </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">covariate =</span> bei.extra<span class="sc">$</span>elev,</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">which =</span> <span class="st">"Z2"</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Berman Z2 test of CSR in two dimensions</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  covariate ‘bei.extra$elev’ evaluated at points of ‘bei’ </span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   and transformed to uniform distribution under CSR</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Z2 = 2.4518, p-value = 0.01422</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(berm_bei_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><span class="arg-text">which = “Z1”</span> by default</li>
<li>There’s no legend, but the dashed line is the expected (Null) and the solid is observed just like the cdf test.</li>
<li>The two vertical lines which show the mean values of the empirical and null distributions</li>
<li>Z1 Test
<ul>
<li>In contrast to the cdf test, this p-value is large and therefore can’t provide evidence that elevation is a predictor of intensity.</li>
<li>But the deviation between the two distribution curves is roughly symmetrical, so the two distributions have approximately equal means — that is, the average terrain elevation of a Beilschmiedia tree is roughly equal to the average terrain elevation in the study region. The Z1 test statistic is a comparison between the two mean values, and <em>is not sensitive to this type of deviation</em></li>
</ul></li>
<li>Z2 Test
<ul>
<li>This p-value is low enough to reject the Null which gives evidence that elevation is a predictor of elevation. Note that it is not as low as the p-value in the cdf test</li>
</ul></li>
</ul></li>
</ul></li>
<li><u>ROC-AUC</u>
<ul>
<li><p>Used to measure of the strength of the effect of the covariate. The larger the AUC, the more discriminatory power the covariate has.</p></li>
<li><p>If the ROC falls along the diagonal, then the covariate has no disciminatory power. The closer the curve gets the Y-Axis, the better discriminatory power the covariate has.</p></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat}</span> book, p.&nbsp;187</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Copper</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Gold</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p><a href="_resources/Geospatial-Point-Patterns.resources/int-roc-ex1-cop-1.png" class="lightbox" data-gallery="roc-ex1"><img src="_resources/Geospatial-Point-Patterns.resources/int-roc-ex1-cop-1.png" class="img-fluid" width="432"></a></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>coproc <span class="ot">&lt;-</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(copper,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">roc</span>(SouthPoints, </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">distfun</span>(SouthLines), </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">high=</span><span class="cn">FALSE</span>))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coproc)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(copper, </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">auc</span>(SouthPoints, </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">distfun</span>(SouthLines), </span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">high =</span> <span class="cn">FALSE</span>))</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4612</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>X-Axis: The fraction of window area that lies within a distance z of the covariate (linement locations, i.e.&nbsp;fault lines)</li>
<li>Y-Axis: The fraction of copper (<span class="var-text">SouthPoints</span>) or gold (<span class="var-text">gold</span>) deposits which fall in this window area</li>
<li><span class="arg-text">high = TRUE</span> says favor high (or low) values of the covariate when calculating the ROC curve.
<ul>
<li>I’m not sure of the purpose behind this.</li>
</ul></li>
<li><code>distfun</code> calculates the distance from a location (copper, gold deposit) to the nearest neighbor (fault line)</li>
<li>The distance-to-fault line covariate has essentially no discriminatory power as can be seen by the ROC hugging the diagonal
<ul>
<li>i.e.&nbsp;There aren’t values of the distance covariate that divide the window into regions of high and low density of copper deposits with sufficient accuracy.</li>
</ul></li>
<li>This is confirmed by the really low AUC, 0.46, which is worse than flipping a coin.</li>
</ul>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p><a href="_resources/Geospatial-Point-Patterns.resources/int-roc-ex1-gold-1.png" class="lightbox" data-gallery="roc-ex1"><img src="_resources/Geospatial-Point-Patterns.resources/int-roc-ex1-gold-1.png" class="img-fluid" width="432"></a></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>murroc <span class="ot">&lt;-</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(murchison, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">roc</span>(gold, </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">distfun</span>(faults), </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">high=</span><span class="cn">FALSE</span>))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(murroc)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(murchison, </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">auc</span>(gold, </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">distfun</span>(faults), </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">high =</span> <span class="cn">FALSE</span>))</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.8873</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The distance-to-fault line covariate has strong discriminatory power as can be seen by the ROC curving upward far beyond the diagaonal.</li>
<li>The plot shows that, by considering parcels of land lying closer than a specified distance away from the nearest geological fault, we can find 80% of the gold deposits in 20% of the land area.</li>
<li>This is confirmed by the high AUC, 0.89.</li>
</ul>
</div>
</div>
</div></li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="sec-geo-ptpat-ostuff" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sec-geo-ptpat-ostuff">Other Stuff</h2>
<ul>
<li>Making some general notes on things that I’m not digging deeper into at this time, but that I still want to include while it’s still fresh in my mind.</li>
<li>Modeling
<ul>
<li>Analyzing data using a summary statistic or summary function is ultimately unsatisfactory.
<ul>
<li>If the test fails to reject the Null, then the question is whether reducing the data to a summary statistic discarded important information.</li>
<li>If the test rejects the Null, then the question is whether the summary statistic may have been ‘fooled’ by some other aspect of the data, such as the non-uniform density of points.</li>
</ul></li>
<li>Diagnostics
<ul>
<li>Influence - A value measuring how much the fitted model would change if the point were deleted from the dataset. Circle diameter is proportional to the influence of the point.
<ul>
<li>A cluster of overly influential points suggests that either these data points are anomalies, or the assumed model is not appropriate for the data</li>
</ul></li>
<li>Smoothed Residuals - Analogous to regression residuals. Substantial deviations from zero suggest that this model does not fit well, and indicate the locations where it does not fit.</li>
</ul></li>
</ul></li>
</ul>
<section id="marked-point-patterns" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="marked-point-patterns">Marked Point Patterns</h3>
<ul>
<li>Points with labels</li>
<li>Basically analysis using 1 variable (label) + coordinates where the variable has information about the event at the location of the coordinates.</li>
<li>Subset marks: e.g.&nbsp;<code>diameter &lt;- marks(finpines)$diameter</code></li>
<li><u>Correlation</u>: Measures the correlation between marks of points separated by a given distance <span class="math inline">\(r\)</span>.
<ul>
<li><span style="color: green">Example</span>: A dataset of spruce tree locations that also has their heights. The spatial correlation will tell us if trees of similar heights near each other or further away.</li>
<li><code>spatstat.explore::markcorr</code>
<ul>
<li>Under mark independence, the mark correlation function should be approximately constant (e.g., close to 1 for standardized marks).</li>
<li>If <span class="math inline">\(\text{markcorr}(r) \gt 1\)</span> , it suggests <em>positive correlation</em> between marks at distance r (e.g., tall trees tend to be near other tall trees).</li>
<li>If <span class="math inline">\(\text{markcorr} \lt 1\)</span>, it suggests <em>negative correlation</em> between marks at distance r (e.g., tall trees tend to be near short trees).</li>
</ul></li>
<li>(<code>spatstat.explore::markvario</code>)
<ul>
<li>A spatial variogram measures the variance between marks of points separated by a given distance <span class="math inline">\(r\)</span></li>
<li>If the estimated variance is greater than the theoretical variance (a constant), <span class="math inline">\(\hat \gamma (r) \gt \gamma (r)\)</span>, then marked points at that distance have greater variance and are more dissimilar to each other. (implies negative spatial correlation)</li>
<li>If <span class="math inline">\(\hat \gamma (r) \approx \gamma (r)\)</span>, then marked points are independent at that distance. (implies spatial independence)</li>
<li>If <span class="math inline">\(\hat \gamma (r) \lt \gamma (r)\)</span>, then marked points have smaller variance and are more similar. (implies positive spatial correlation)</li>
</ul></li>
</ul></li>
<li><u>Interactions</u>: Analyze the spatial interaction between <em>two</em> different types of points (e.g.&nbsp;one factor variable w/two levels)
<ul>
<li><code>spatstat.explore::Lcross</code>
<ul>
<li>Requires a multitype point pattern (a marked point pattern whose marks are a factor).
<ul>
<li>e.g.&nbsp;Do trees of species A tend to be close to trees of species B? (species would be a factor variable with levels: A and B)</li>
</ul></li>
<li><span class="math inline">\(\hat L (r) \gt r\)</span> : Clustering between category 1 and category 2 at distance <span class="math inline">\(r\)</span>.</li>
<li><span class="math inline">\(\hat L (r) \approx r\)</span> : Independence between category 1 and category 2 at distance <span class="math inline">\(r\)</span>.</li>
<li><span class="math inline">\(\hat L (r) \lt r\)</span> : Inhibition (repulsion) between category 1 and category 2 at distance <span class="math inline">\(r\)</span>.</li>
<li>If you want to see if the individual categories have random (i.e.&nbsp;poisson) patterns, use <code>Kall &lt;- alltypes(rescale(amacrine), Lcross)</code>. In the matrix plot, the diagonal with have the components (i.e.&nbsp;category 1 vs category 1 and category 2 vs category 2).</li>
</ul></li>
<li>There is no <code>Lmulti</code> but there is a <code>Kmulti</code> which is the same as <code>Kcross</code> except instead of the variable needing to be a factor, it can be any form of dichotomization, e.g.&nbsp;diameter &gt;= 15 and diameter &lt; 15 or collapsing multiple categories into 2 categories.</li>
<li>I-Function
<ul>
<li>Summarizes the association between all types in a multi-type point process</li>
<li>Formula<br>
<span class="math display">\[
I(r) = \sum_{i = 1}^m  p_i J_{ii}(r) - J_{\boldsymbol{\cdot}\boldsymbol{\cdot}} (r)
\]</span>
<ul>
<li><span class="math inline">\(p_i\)</span> is the proportion of type <span class="math inline">\(i\)</span> events</li>
<li><span class="math inline">\(J_{ii}\)</span> is the <span class="math inline">\(J\)</span> function for only type <span class="math inline">\(i\)</span> events</li>
<li><span class="math inline">\(J_{\boldsymbol{\cdot}\boldsymbol{\cdot}}\)</span> is the standard J function that doesn’t take types into account</li>
</ul></li>
<li>Assumes stationarity</li>
<li>Guidelines
<ul>
<li><span class="math inline">\(I(r) \gt 1\)</span> suggests a positive association between all types</li>
<li><span class="math inline">\(I(r) = 0\)</span> if all types (i.e.&nbsp;categories) are independent of each other</li>
<li><span class="math inline">\(I(r) \lt 1\)</span> suggests a negative association between all types</li>
</ul></li>
</ul></li>
</ul></li>
<li><u>Dot Functions</u>
<ul>
<li>Analyzes the spatial dependence between 1 category of a variable and the rest of its categories.</li>
<li>Requires the variable to be a factor, but seems to accept factor variables with more than 2 levels</li>
<li>Example of Guidelines (e.g.&nbsp;<code>Gdot</code>)
<ul>
<li><span class="math inline">\(\hat G_{i \boldsymbol\cdot} \gt G_{i \boldsymbol\cdot}\)</span> says that category <span class="math inline">\(i\)</span> events are <em>closer</em> to any type of category event than expected from a random process, i.e.&nbsp;<em>Clustered</em></li>
<li><span class="math inline">\(\hat G_{i \boldsymbol\cdot} \approx G_{i \boldsymbol\cdot}\)</span> says that category <span class="math inline">\(i\)</span> events are spatially independent of category event types</li>
<li><span class="math inline">\(\hat G_{i \boldsymbol\cdot} \lt G_{i \boldsymbol\cdot}\)</span> says that category <span class="math inline">\(i\)</span> events are <em>further</em> from any type of category event than expected from a random process, i.e.&nbsp;<em>regularity (dispersion)</em></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="inhomogeneity" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="inhomogeneity">Inhomogeneity</h3>
<ul>
<li><p>Instead of assuming the process is stationary, the assumption for inhomogeneous functions is that the process is <strong>corrrelation-stationary</strong>. In other words, it assumes that the spatial scale of interaction (i.e.&nbsp;correlation) remains <em>constant</em>, while the intensity is spatially <em>varying</em>. This is not always the case for inhomogeneous point processes.</p>
<ul>
<li>A formal test for correlation-stationarity is described in Section 16.8.5</li>
</ul></li>
<li><p>The functions require an estimate of the intensity function <span class="math inline">\(\lambda(u)\)</span> :</p>
<ul>
<li>User-Supplied: A vector of intensity values at the data points, a pixel image, a function, or a fitted point process model (ppm).
<ul>
<li>To reduce bias it is advisable to use a leave-one-out intensity estimator</li>
</ul></li>
<li>Otherwise, <span class="math inline">\(\lambda(u)\)</span> will be estimated from the data by a leave-one-out kernel smoother. Manually this would be <code>density(swp, sigma = bw.diggle, at="points")</code>.</li>
</ul></li>
<li><p>On p.&nbsp;689 in the <span style="color: #990000">{spatstat}</span> book, a permutation test procedure is performed to test whether a point pattern is correlation-stationary (inhomogeneous) or locally scaled. Testing for whether the pattern is homogeneous or locally scaled and inhomogeneous, etc. could also have been done as well I think.</p></li>
<li><p><span class="ribbon-highlight">Example</span>: <span style="color: #990000">{spatstat}</span> book, pp.&nbsp;244-246</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Homogeneous K and L</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Inhomogeneous K and L</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">Global Envelope</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/inhom-ex1-numata-ppp-1.png" class="lightbox" data-gallery="inhom-num-pd" title="Point Pattern"><img src="_resources/Geospatial-Point-Patterns.resources/inhom-ex1-numata-ppp-1.png" class="img-fluid figure-img" width="332" alt="Point Pattern"></a></p>
<figcaption>Point Pattern</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/inhom-ex1-numata-dens-1.png" class="lightbox" data-gallery="inhom-num-pd" title="Density"><img src="_resources/Geospatial-Point-Patterns.resources/inhom-ex1-numata-dens-1.png" class="img-fluid figure-img" width="332" alt="Density"></a></p>
<figcaption>Density</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>numata <span class="ot">&lt;-</span> residualspaper<span class="sc">$</span>Fig1</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(numata)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>lam_numata <span class="ot">&lt;-</span> <span class="fu">density</span>(numata, bw.ppl)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lam_numata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Japanese Black Pine seedlings and saplings in a 10 meter square study region</li>
<li>Intensity doesn’t seem to be homogeneous. Is it random inhomogneous though?</li>
</ul>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/inhom-ex1-num-k-1.png" class="lightbox" data-gallery="inhom-num-kl" title="K-Function"><img src="_resources/Geospatial-Point-Patterns.resources/inhom-ex1-num-k-1.png" class="img-fluid figure-img" width="332" alt="K-Function"></a></p>
<figcaption>K-Function</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/inhom-ex1-num-l-1.png" class="lightbox" data-gallery="inhom-num-kl" title="L-Function"><img src="_resources/Geospatial-Point-Patterns.resources/inhom-ex1-num-l-1.png" class="img-fluid figure-img" width="332" alt="L-Function"></a></p>
<figcaption>L-Function</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>k_numata <span class="ot">&lt;-</span> <span class="fu">Kest</span>(numata, <span class="at">correction =</span> <span class="st">"best"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k_numata)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>l_numata <span class="ot">&lt;-</span> <span class="fu">Lest</span>(numata, <span class="at">correction =</span> <span class="st">"best"</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(l_numata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The K-Function pretty much follows the homogeneous, random poisson process line, so this could suggest CSR.</li>
<li>The more powerful L-Function tells a different story though. It suggests inhibition at small <span class="math inline">\(r\)</span> distances.</li>
</ul>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/inhom-ex1-num-kin-1.png" class="lightbox" data-gallery="inhom-num-klin" title="Inhomogenous K"><img src="_resources/Geospatial-Point-Patterns.resources/inhom-ex1-num-kin-1.png" class="img-fluid figure-img" width="332" alt="Inhomogenous K"></a></p>
<figcaption>Inhomogenous K</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/inhom-ex1-num-lin-1.png" class="lightbox" data-gallery="inhom-num-klin" title="Inhomogenous L"><img src="_resources/Geospatial-Point-Patterns.resources/inhom-ex1-num-lin-1.png" class="img-fluid figure-img" width="332" alt="Inhomogenous L"></a></p>
<figcaption>Inhomogenous L</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>kin_numata <span class="ot">&lt;-</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Kinhom</span>(numata, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">sigma =</span> bw.ppl, </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">correction =</span> <span class="st">"best"</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kin_numata)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>lin_numata <span class="ot">&lt;-</span> </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Linhom</span>(numata, </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">sigma =</span> bw.ppl,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">correction =</span> <span class="st">"best"</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lin_numata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Same interpretation as before except the inhomogeneous K-Function would suggest a inhomogeneous, random poisson process.</li>
</ul>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="_resources/Geospatial-Point-Patterns.resources/inhom-ex1-num-lin-env-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-42" title="Inhomogenous L Envelope"><img src="_resources/Geospatial-Point-Patterns.resources/inhom-ex1-num-lin-env-1.png" class="img-fluid figure-img" width="432" alt="Inhomogenous L Envelope"></a></p>
<figcaption>Inhomogenous L Envelope</figcaption>
</figure>
</div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>env_lin_numata <span class="ot">&lt;-</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">envelope</span>(numata, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>           Linhom, </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">sigma =</span> bw.ppl,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">correction =</span> <span class="st">"best"</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">simulate =</span> <span class="fu">expression</span>(<span class="fu">rpoispp</span>(lam_numata)),</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">use.theory =</span> <span class="cn">TRUE</span>, </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">nsim =</span> <span class="dv">19</span>, </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">global =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>env_lin_numata</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simultaneous critical envelopes for L[inhom](r)</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; and observed value for ‘numata’</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Edge correction: “iso”</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Obtained from 19 evaluations of user-supplied expression</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Envelope based on maximum deviation of L[inhom](r) from null value (known exactly)</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Alternative: two.sided</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Significance level of simultaneous Monte Carlo test: 1/20 = 0.05</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ............................................................................</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Math.label               Description                                   </span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; r    r                        distance argument r                           </span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; obs  {hat(L)[inhom]^{obs}}(r) observed value of L[inhom](r) for data pattern</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theo {L[inhom]^{theo}}(r)     theoretical value of L[inhom](r)              </span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lo   {hat(L)[inhom]^{lo}}(r)  lower critical boundary for L[inhom](r)       </span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; hi   {hat(L)[inhom]^{hi}}(r)  upper critical boundary for L[inhom](r)       </span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ............................................................................</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Default plot formula:  .~r</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; where “.” stands for ‘obs’, ‘theo’, ‘hi’, ‘lo’</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Columns ‘lo’ and ‘hi’ will be plotted as shading (by default)</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Recommended range of argument r: [0, 2.5]</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Available range of argument r: [0, 2.5]</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Unit of length: 1 metre</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(env_lin_numata, . <span class="sc">-</span> r <span class="sc">~</span> r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The inhomogeneous L-Function escapes the envelope, so the Null (inhomogeneous random poisson process) is rejected at <span class="math inline">\(\alpha = 0.05\)</span> (since the number of simulations = 19).</li>
<li>As with the previous L-Function results, inhibition is suggested at small r distances.</li>
<li><code>. - r ~ r</code> centers the L-Function at 0 for easier interpretation</li>
</ul>
</div>
</div>
</div></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../qmd/geospatial-modeling.html" class="pagination-link" aria-label="Modeling">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Modeling</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../qmd/geospatial-processing.html" class="pagination-link" aria-label="Preprocessing">
        <span class="nav-page-text">Preprocessing</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../LICENSE.html">
<p>Creative Commons Attribution-NonCommercial 4.0 International License</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>